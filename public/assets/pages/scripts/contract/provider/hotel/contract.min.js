$(document).ready(function(){var r=!1,g=null;function k(e){return $('tbody > tr > td:nth-child(1) input[type="checkbox"]:checked',e).size()}function l(a){var t=[];return $('tbody > tr > td:nth-child(1) input[type="checkbox"]:checked',a).each(function(){var e=a.api().row($(this).parents("tr")).data();t.push(e[1])}),t}function x(e){$("tbody > tr",e).each(function(){$(this).removeClass("active")})}$("#modal-add .btn-hotel-details").on("click",function(){$("#modal-add .hotel-details").each(function(){$(this).hasClass("hidden")?$(this).removeClass("hidden"):$(this).addClass("hidden")})}),$("#modal-info .btn-hotel-details").on("click",function(){$("#modal-info .hotel-details").each(function(){$(this).hasClass("hidden")?$(this).removeClass("hidden"):$(this).addClass("hidden")})}),$("#modal-edit .btn-hotel-details").on("click",function(){$("#modal-edit .hotel-details").each(function(){$(this).hasClass("hidden")?$(this).removeClass("hidden"):$(this).addClass("hidden")})}),$("#modal-add [id=rate_fee_value_1_add]").TouchSpin({min:-1e9,max:1e9,stepinterval:50,step:.01,decimals:2,maxboostedstep:10,prefix:"$"}),$("#modal-add [id=rate_percent_value_1_add]").TouchSpin({min:-100,max:100,step:.01,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#modal-add [id=rate_type_percent_1_add]").change(function(){$("#modal-add [id=rate_fee_value_1_add]").val(""),$("#modal-add [id=rate_fee_value_1_add]").attr("disabled","disabled"),$("#modal-add [id=rate_percent_value_1_add]").removeAttr("disabled")}),$("#modal-add [id=rate_type_fee_1_add]").change(function(){$("#modal-add [id=rate_percent_value_1_add]").val(""),$("#modal-add [id=rate_percent_value_1_add]").attr("disabled","disabled"),$("#modal-add [id=rate_fee_value_1_add]").removeAttr("disabled")}),$("#modal-add :input[name=select-markets]").multiSelect({afterSelect:function(e){var a='<li data-tab="'+e+'">',t='<div class="tab-pane" id="tab_'+e+'_add" data-tab="'+e+'">';a+='<a href="#tab_'+e+'_add" data-toggle="tab"> '+$("#modal-add :input[name=select-markets] option[value="+e+"]").html()+" </a></li>",t+='<div class="row" style="margin-top:15px;"><div class="col-md-6 col-sm-6 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="rate_type_'+e+'" id="rate_type_percent_'+e+'_add" value="1" data-target="rate_percent_value_'+e+'_add" data-market="'+e+'" checked><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="" name="rate_percent_value_'+e+'" id="rate_percent_value_'+e+'_add"/></div><span style="margin-top: 8px;"></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="rate_type_'+e+'" id="rate_type_fee_'+e+'_add" value="2" data-target="rate_fee_value_'+e+'_add" data-market="'+e+'"><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="" name="rate_fee_value_'+e+'" id="rate_fee_value_'+e+'_add" disabled/></div><span style="margin-top: 8px;"></span></label></div></div><div class="col-md-6 col-sm-6 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_add" id="round_method_1_'+e+'" value="1" data-market="'+e+'" checked> Default Round<span></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_add" id="round_method_2_'+e+'" value="2" data-market="'+e+'"> Integer Round<span></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_add" id="round_method_3_'+e+'" value="3" data-market="'+e+'"> Integer Round Up<span></span></label></div></div></div>',t+="</div>",$("#modal-add .market-rate-container .custom-tab").append(a),$("#modal-add .market-rate-container .custom-content").append(t),$("#modal-add .market-rate-container").show(),$("#rate_fee_value_"+e+"_add").TouchSpin({min:-1e9,max:1e9,stepinterval:50,step:.01,decimals:2,maxboostedstep:10,prefix:"$"}),$("#rate_percent_value_"+e+"_add").TouchSpin({min:-100,max:100,step:.01,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#rate_type_percent_"+e+"_add").change(function(){$("#rate_fee_value_"+e+"_add").val(""),$("#rate_fee_value_"+e+"_add").attr("disabled","disabled"),$("#rate_percent_value_"+e+"_add").removeAttr("disabled")}),$("#rate_type_fee_"+e+"_add").change(function(){$("#rate_percent_value_"+e+"_add").val(""),$("#rate_percent_value_"+e+"_add").attr("disabled","disabled"),$("#rate_fee_value_"+e+"_add").removeAttr("disabled")})},afterDeselect:function(e){$('#modal-add [data-tab="'+e+'"]').remove(),$("#modal-add .nav-tabs li").children("a").first().click()},keepOrder:!0}),$("#search-section :input[name=valid-from]").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"dd.mm.yyyy",orientation:"bottom"}),$("#search-section :input[name=valid-to]").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"dd.mm.yyyy",orientation:"bottom"}),$("#modal-add :input[name=valid-from]").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"dd.mm.yyyy",orientation:"bottom"}).on("changeDate",function(e){var a=$(this).val(),t=$("#modal-add :input[name=valid-to]").val(),i=moment(a,"DD.MM.YYYY"),d=moment(t,"DD.MM.YYYY");(""==t||0!=a&&""!=a&&moment(d).isBefore(i))&&$("#modal-add :input[name=valid-to]").datepicker("setDate",new Date(moment(a,"DD.MM.YYYY")))}),$("#modal-add :input[name=valid-to]").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"dd.mm.yyyy",orientation:"bottom"}).on("changeDate",function(e){var a=$(this).val(),t=$('#modal-add :input[name="valid-from"]').val(),i=moment(t,"DD.MM.YYYY"),d=moment(a,"DD.MM.YYYY");(""==t||0!=t&&""!=t&&moment(d).isBefore(i))&&$('#modal-add :input[name="valid-from"]').datepicker("setDate",new Date(moment(a,"DD.MM.YYYY")))}),$("#modal-edit :input[name=valid-from]").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"dd.mm.yyyy",orientation:"bottom"}).on("changeDate",function(e){var a=$(this).val(),t=$("#modal-edit :input[name=valid-to]").val(),i=moment(a,"DD.MM.YYYY"),d=moment(t,"DD.MM.YYYY");(""==t||0!=a&&""!=a&&moment(d).isBefore(i))&&$("#modal-edit :input[name=valid-to]").datepicker("setDate",new Date(moment(a,"DD.MM.YYYY")))}),$("#modal-edit :input[name=valid-to]").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"dd.mm.yyyy",orientation:"bottom"}).on("changeDate",function(e){var a=$(this).val(),t=$('#modal-edit :input[name="valid-from"]').val(),i=moment(t,"DD.MM.YYYY"),d=moment(a,"DD.MM.YYYY");(""==t||0!=t&&""!=t&&moment(d).isBefore(i))&&$('#modal-edit :input[name="valid-from"]').datepicker("setDate",new Date(moment(a,"DD.MM.YYYY")))}),$(".hotel-category").barrating({theme:"fontawesome-stars"}),$("#modal-add .toggle-hotel").on("click",function(){$("#modal-add .show-hotel").slideToggle()}),$("#modal-add :input[name=category]").barrating("readonly",!0),$("#modal-info :input[name=category]").barrating("readonly",!0),$("#modal-edit :input[name=category]").barrating("readonly",!0),$.fn.dataTable.ext.errMode="none";var w=$("#table").on("error.dt",function(e,a,t,i){}).on("processing.dt",function(e,a,t){App.showMask(t,$(this)),App.reloadToolTips()}).on("init.dt",function(){}).DataTable({processing:!0,serverSide:!0,sDom:"ltip",iDisplayLength:25,ajax:{url:routeRead,type:"POST",complete:function(e,a){"419"==e.status?location.reload(!0):"200"!=e.status&&toastr.error("Please check your connection and try again.","Error on loading the content"),$(".br-readonly").on("click",function(e){e.preventDefault()})}},order:[[1,"asc"]],columns:[{data:"id",name:"id",visible:!1},{data:"name",name:"name"},{data:"hotel",name:"hotel",orderable:!1},{data:"location",name:"location",orderable:!1},{data:"valid_from",name:"valid_from"},{data:"valid_to",name:"valid_to"},{data:"status",name:"status",orderable:!1,data:function(e,a,t,i){var d="";return"3"==e.status?d='<span class="label label-sm label-danger"> Finished </span>':"2"==e.status?d='<span class="label label-sm label-success"> In Progress </span>':"1"==e.status&&(d='<span class="label label-sm label-warning"> Pending </span>'),d}},{data:"active",name:"active",className:"dt-center",data:function(e,a,t,i){var d='<span><i class="fa fa-close dt-active dt-active-0"></i></span>';return 1==e.active&&(d='<span><i class="fa fa-check dt-active dt-active-1"></i></span>'),d}},{targets:"actions",orderable:!1,name:"actions",className:"dt-center nobreakline",data:function(e,a,t,i){return'<form method="get" action="'+routeSetting+'"><input type="hidden" name="id" value="'+e.id+'"><div class="dt-actions"><a class="btn btn-default btn-circle btn-icon-only btn-action dt-view" data-toggle="modal" href="#modal-info"><i class="glyphicon glyphicon-eye-open btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-edit" data-toggle="modal" href="#modal-edit"><i class="icon-pencil btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-delete" href="javascript:;" data-popout="true" data-placement="left"data-btn-ok-label="Yes" data-btn-ok-class="btn-sm btn-success"  data-btn-ok-icon-content="check" data-btn-cancel-label="No" data-btn-cancel-class="btn-sm btn-danger" data-btn-cancel-icon-content="close" data-title="Are you sure?" data-content=""><i class="icon-trash btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-duplicate" href="javascript:;" data-popout="true" data-placement="left"data-btn-ok-label="Yes" data-btn-ok-class="btn-sm btn-success btn-confirmation"  data-btn-ok-icon-content="check" data-btn-cancel-label="No" data-btn-cancel-class="btn-sm btn-danger btn-confirmation" data-btn-cancel-icon-content="close" data-title="Are you sure?" data-content=""><i class="icon-docs btn-action-icon"></i></a><button type="submit" class="btn btn-default btn-circle btn-icon-only btn-action dt-setting"><i class="icon-settings btn-action-icon"></i></button></div></form>'}}]});$("#table_length").hide(),$(".search").on("click",function(e){$("#search-section").slideToggle()}),$(".reload").on("click",function(e){w.draw()}),$(".add").on("click",function(){o.validate().resetForm(),o[0].reset(),$("#modal-add :input[name=category]").barrating("set",""),p.api().clear().draw(),$("#modal-add .js-data-ajax").val(null).trigger("change"),$("#modal-add .select-hotel").val(null).trigger("change"),x(c),x(s),x(m),$("#modal-add :input[name=select-markets]").multiSelect("deselect_all"),$("#modal-add [data-tab]").each(function(){"1"!=$(this).attr("data-tab")&&$(this).remove()}),$("#modal-add .ms-elem-selectable").removeClass("ms-hover"),$("#modal-add .hotel-details").each(function(){$(this).hasClass("hidden")||$(this).addClass("hidden")})}),$(".lenght-option").on("click",function(){var e=$(this).attr("data");$(this).parent().parent().prev("a").text(e);var a=$("select[name=table_length]");a.val(e),a.change()}),$.validator.addMethod("validMarketPriceRate",function(e,a,t){var i=!0;return $('#modal-add [name^="rate_type_"]').each(function(){if($(this).prop("checked")){var e=$(this).attr("data-target"),a=$("#"+e).val();if(""==a||null==a)return i=!1}}),i},"Some market rate price is invalid.");var o=$("#form-add");o.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{required:!0},hotel:{required:!0},status:{required:!0},"valid-from":{required:!0,validDate:!0},"valid-to":{required:!0,validDate:!0},"count-board-type":{greaterThanZero:!0},"count-pax-type":{greaterThanZero:!0},"count-room-type":{greaterThanZero:!0},"market-rate-price":{validMarketPriceRate:!0}},errorPlacement:function(e,a){0<a.parents(".mt-radio-list").size()||0<a.parents(".mt-checkbox-list").size()?(0<a.parents(".mt-radio-list").size()&&e.appendTo(a.parents(".mt-radio-list")[0]),0<a.parents(".mt-checkbox-list").size()&&e.appendTo(a.parents(".mt-checkbox-list")[0])):0<a.parents(".mt-radio-inline").size()||0<a.parents(".mt-checkbox-inline").size()?(0<a.parents(".mt-radio-inline").size()&&e.appendTo(a.parents(".mt-radio-inline")[0]),0<a.parents(".mt-checkbox-inline").size()&&e.appendTo(a.parents(".mt-checkbox-inline")[0])):0<a.parent(".input-group").size()?e.insertAfter(a.parent(".input-group")):a.attr("data-error-container")?e.appendTo(a.attr("data-error-container")):a.hasClass("hotel-category")?e.insertAfter(a.next()):a.hasClass("hotel-type")?e.insertAfter(a.next()):a.hasClass("select-hotel")?e.insertAfter(a.next()):a.hasClass("market-rate-price-type")?(e.appendTo(".market-rate-container-error"),$(".market-rate-container-error > span").css("color","#e73d4a")):e.insertAfter(a)},invalidHandler:function(e,a){toastr.error("Please check the entry fields.","Error")},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error")},submitHandler:function(i){var d=$(i).find("button[type=submit]:focus").attr("data"),e=new FormData(o[0]),a=[];$('#modal-add [name="check-measures[]"]').each(function(){$(this).prop("checked")&&a.push($(this).attr("data"))});var n=[];$('#modal-add [name^="rate_type_"]:checked').each(function(){var e=$(this).attr("data-target"),a=$(this).attr("data-market"),t=$("#"+e).val(),i=$('#modal-add :input[name="round_method_'+a+'_add"]:checked').val(),d={market_id:a,rate_type:$(this).val(),value:t,round_type:i};n.push(d)}),e.append("paxTypes",JSON.stringify(l(s))),e.append("boardTypes",JSON.stringify(l(c))),e.append("markets",JSON.stringify(l(m))),e.append("roomTypes",JSON.stringify($("#modal-add .js-data-ajax").val())),e.append("measures",JSON.stringify(a)),e.append("markets",JSON.stringify(n)),$.ajax({url:routeCreate,type:"POST",data:e,contentType:!1,processData:!1,beforeSend:function(){App.showMask(!0,o)},complete:function(e,a){if(App.showMask(!1,o),"419"==e.status)location.reload(!0);else if("200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"success"==t.status?(toastr.success(t.message,"Success"),o[0].reset(),r=!0,"accept"==d&&$(i).find("button.cancel-form").click(),p.api().clear().draw(),$("#modal-add .js-data-ajax").val(null).trigger("change"),$("#modal-add .select-hotel").val(null).trigger("change"),x(c),x(s),x(m)):toastr.error(t.message,"Error")}}})}}),$(".mt-checkbox").change(function(){$(".mt-checkbox > input[type=checkbox]").is(":checked")?$(".mt-checkbox > input[type=checkbox]").val(1):$(".mt-checkbox > input[type=checkbox]").val(0)}),$.validator.addMethod("validMarketPriceRate2",function(e,a,t){var i=!0;return $('#modal-edit [name^="rate_type_"]').each(function(){if($(this).prop("checked")){var e=$(this).attr("data-target"),a=$("#"+e).val();if(""==a||null==a)return i=!1}}),i},"Some market rate price is invalid.");var D=$("#form-edit");D.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{required:!0},"hotel-id":{required:!0},status:{required:!0},"valid-from":{required:!0,validDate:!0},"valid-to":{required:!0,validDate:!0},"count-board-type":{greaterThanZero:!0},"count-pax-type":{greaterThanZero:!0},"count-room-type":{greaterThanZero:!0},"market-rate-price":{validMarketPriceRate2:!0}},errorPlacement:function(e,a){0<a.parents(".mt-radio-list").size()||0<a.parents(".mt-checkbox-list").size()?(0<a.parents(".mt-radio-list").size()&&e.appendTo(a.parents(".mt-radio-list")[0]),0<a.parents(".mt-checkbox-list").size()&&e.appendTo(a.parents(".mt-checkbox-list")[0])):0<a.parents(".mt-radio-inline").size()||0<a.parents(".mt-checkbox-inline").size()?(0<a.parents(".mt-radio-inline").size()&&e.appendTo(a.parents(".mt-radio-inline")[0]),0<a.parents(".mt-checkbox-inline").size()&&e.appendTo(a.parents(".mt-checkbox-inline")[0])):0<a.parent(".input-group").size()?e.insertAfter(a.parent(".input-group")):a.attr("data-error-container")?e.appendTo(a.attr("data-error-container")):a.hasClass("hotel-category")?e.insertAfter(a.next()):a.hasClass("hotel-type")?e.insertAfter(a.next()):a.hasClass("market-rate-price-type")?(e.appendTo(".market-rate-container-error"),$(".market-rate-container-error > span").css("color","#e73d4a")):e.insertAfter(a)},invalidHandler:function(e,a){toastr.error("Please check the entry fields.","Error")},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error")},submitHandler:function(i){var e=new FormData(D[0]),a=[];$('#modal-edit [name="check-measures[]"]').each(function(){$(this).prop("checked")&&a.push($(this).attr("data"))});var o=[];$('#modal-edit [name^="rate_type_"]:checked').each(function(){var e=$(this).attr("data-target"),a=$(this).attr("data-market"),t=$("#"+e).val(),i=$('#modal-edit :input[name="round_method_'+a+'_edit"]:checked').val(),d=$('#modal-edit :input[name="update_prices_'+a+'_edit"]:checked').val(),n={market_id:a,rate_type:$(this).val(),value:t,round_type:i,update_price:null==d?"0":d};o.push(n)});var t=l(T),d=l(M),n=$("#modal-edit .js-data-ajax").val();e.get("active");e.append("paxTypes",JSON.stringify(t)),e.append("boardTypes",JSON.stringify(d)),e.append("roomTypes",JSON.stringify(n)),e.append("measures",JSON.stringify(a)),e.append("markets",JSON.stringify(o)),$.ajax({url:routeUpdate,type:"POST",data:e,contentType:!1,processData:!1,beforeSend:function(){App.showMask(!0,D)},complete:function(e,a){if(App.showMask(!1,D),"419"==e.status)location.reload(!0);else if("200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"419"==e.status?location.reload(!0):"success"==t.status?(toastr.success(t.message,"Success"),r=!0,$(i).find("button.cancel-form").click()):toastr.error(t.message,"Error"),x(M),x(T)}}})}}),$("#rate_fee_value_1_info").TouchSpin({min:-1e9,max:1e9,stepinterval:50,step:.01,decimals:2,maxboostedstep:10,prefix:"$"}),$("#rate_percent_value_1_info").TouchSpin({min:-100,max:100,step:.01,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#table tbody").on("click",".dt-view",function(e){var a=w.row($(this).parents("tr")).data(),t=a.object,i=t.hotel,d=t.pax_types,n=t.board_types,o=t.room_types,r=t.measures,l=t.markets,s=null!=i.country?i.country.name:"",c=null!=i.state?i.state.name:"",m=null!=i.city?i.city.name:"",p=null!=i.hotel_chain?i.hotel_chain.name:"";$("#modal-info .hotel-details").each(function(){$(this).hasClass("hidden")||$(this).addClass("hidden")}),$("#modal-info :input[name=name]").val(t.name),$("#modal-info :input[name=valid-from]").val(moment(t.valid_from,"YYYY-MM-DD").format("DD.MM.YYYY")),$("#modal-info :input[name=valid-to]").val(moment(t.valid_to,"YYYY-MM-DD").format("DD.MM.YYYY")),$("#modal-info :input[name=hotel]").val(i.name),$("#modal-info :input[name=country-text]").val(s),$("#modal-info :input[name=state-text]").val(c),$("#modal-info :input[name=city-text]").val(m),$("#modal-info :input[name=postal-code]").val(i.postal_code),$("#modal-info :input[name=address]").val(i.address),$("#modal-info :input[name=category]").barrating("set",i.category),$("#modal-info :input[name=hotel-chain]").val(p),$("#modal-info :input[name=admin-phone]").val(i.admin_phone),$("#modal-info :input[name=admin-fax]").val(i.admin_fax),$("#modal-info :input[name=web-site]").val(i.web_site),$("#modal-info :input[name=turistic-licence]").val(i.turistic_licence),$("#modal-info :input[name=email]").val(i.email),1==a.active?($("#modal-info :input[name=active]").prop("checked","checked"),$("#modal-info :input[name=active]").val(1)):($("#modal-info :input[name=active]").prop("checked",""),$("#modal-info :input[name=active]").val(0)),$('#modal-info [name="check-measures[]"]').prop("checked","");for(var u=0;u<r.length;u++)$('#modal-info [name="check-measures[]"][data="'+r[u].id+'"]').prop("checked","checked");$("#modal-info [data-tab]").each(function(){"1"!=$(this).attr("data-tab")&&$(this).remove()}),$("#modal-info .nav-tabs li").children("a").first().click(),$("#modal-info [id=rate_fee_value_1_info]").val(""),$("#modal-info [id=rate_fee_value_1_info]").attr("disabled","disabled"),$("#modal-info [id=rate_percent_value_1_info]").val(""),$("#modal-info [id=rate_percent_value_1_info]").attr("disabled","disabled");for(u=0;u<l.length;u++){var _=l[u].pivot;if(1==l[u].id)"1"==_.type?($("#modal-info [id=rate_percent_value_1_info]").val(_.value),$("#modal-info [id=rate_type_percent_1_info]").prop("checked","checked")):"2"==_.type&&($("#modal-info [id=rate_fee_value_1_info]").val(_.value),$("#modal-info [id=rate_type_fee_1_info]").prop("checked","checked")),"1"==_.round?$("#modal-info [id=round_method_1_1_info]").prop("checked","checked"):"2"==_.round?$("#modal-info [id=round_method_2_1_info]").prop("checked","checked"):"3"==_.round&&$("#modal-info [id=round_method_3_1_info]").prop("checked","checked");else{var h='<li data-tab="'+l[u].id+'">',v='<div class="tab-pane" id="tab_'+l[u].id+'_info" data-tab="'+l[u].id+'">';h+='<a href="#tab_'+l[u].id+'_info" data-toggle="tab"> '+l[u].name+" </a></li>",v+='<div class="row" style="margin-top:15px;"><div class="col-md-6 col-sm-6 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio">',"1"==_.type?v+='<input type="radio" name="rate_type_'+l[u].id+'" id="rate_type_percent_'+l[u].id+'_info" value="1" data-target="rate_percent_value_'+l[u].id+'_info" data-market="'+l[u].id+'" checked onclick="return false;"><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="'+_.value+'" name="rate_percent_value_'+l[u].id+'" id="rate_percent_value_'+l[u].id+'_info" disabled/></div>':v+='<input type="radio" name="rate_type_'+l[u].id+'" id="rate_type_percent_'+l[u].id+'_info" value="1" data-target="rate_percent_value_'+l[u].id+'_info" data-market="'+l[u].id+'" onclick="return false;"><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="" name="rate_percent_value_'+l[u].id+'" id="rate_percent_value_'+l[u].id+'_info" disabled/></div>',v+='<span style="margin-top: 8px;"></span></label><label class="mt-radio mt-radio-outline custom-radio">',"2"==_.type?v+='<input type="radio" name="rate_type_'+l[u].id+'" id="rate_type_fee_'+l[u].id+'_info" value="2" data-target="rate_fee_value_'+l[u].id+'_info" data-market="'+l[u].id+'" checked onclick="return false;"><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="'+_.value+'" name="rate_fee_value_'+l[u].id+'" id="rate_fee_value_'+l[u].id+'_info" disabled/></div>':v+='<input type="radio" name="rate_type_'+l[u].id+'" id="rate_type_fee_'+l[u].id+'_info" value="2" data-target="rate_fee_value_'+l[u].id+'_info" data-market="'+l[u].id+'" onclick="return false;"><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="" name="rate_fee_value_'+l[u].id+'" id="rate_fee_value_'+l[u].id+'_info" disabled/></div>',v+='<span style="margin-top: 8px;"></span></label></div></div><div class="col-md-6 col-sm-6 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio">',"1"==_.round?v+='<input type="radio" name="round_method_'+l[u].id+'" id="round_method_1_'+l[u].id+'_info" value="1" data-market="'+l[u].id+'" checked onclick="return false;"> Default Round':v+='<input type="radio" name="round_method_'+l[u].id+'" id="round_method_1_'+l[u].id+'_info" value="1" data-market="'+l[u].id+'" onclick="return false;"> Default Round',v+='<span></span></label><label class="mt-radio mt-radio-outline custom-radio">',"2"==_.round?v+='<input type="radio" name="round_method_'+l[u].id+'" id="round_method_2_'+l[u].id+'_info" value="2" data-market="'+l[u].id+'" checked onclick="return false;"> Integer Round':v+='<input type="radio" name="round_method_'+l[u].id+'" id="round_method_2_'+l[u].id+'_info" value="2" data-market="'+l[u].id+'" onclick="return false;"> Integer Round',v+='<span></span></label><label class="mt-radio mt-radio-outline custom-radio">',"3"==_.round?v+='<input type="radio" name="round_method_'+l[u].id+'" id="round_method_3_'+l[u].id+'_info" value="3" data-market="'+l[u].id+'" checked onclick="return false;"> Integer Round Up':v+='<input type="radio" name="round_method_'+l[u].id+'" id="round_method_3_'+l[u].id+'_info" value="3" data-market="'+l[u].id+'" onclick="return false;"> Integer Round Up',v+="<span></span></label></div></div></div>",v+="</div>",$("#modal-info .market-rate-container .custom-tab").append(h),$("#modal-info .market-rate-container .custom-content").append(v),$("#rate_fee_value_"+l[u].id+"_info").TouchSpin({min:-1e9,max:1e9,stepinterval:50,step:.01,decimals:2,maxboostedstep:10,prefix:"$"}),$("#rate_percent_value_"+l[u].id+"_info").TouchSpin({min:-100,max:100,step:.01,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"})}}f.api().clear();for(u=0;u<d.length;u++)f.api().row.add([d[u].id,d[u].code+": "+d[u].name,d[u].agefrom,d[u].ageto]).draw(!1);f.api().columns.adjust().draw(),b.api().clear();for(u=0;u<n.length;u++)b.api().row.add([n[u].id,n[u].code+": "+n[u].name]).draw(!1);b.api().columns.adjust().draw(),y.api().clear();for(u=0;u<o.length;u++)y.api().row.add([o[u].id,o[u].code+": "+o[u].name,o[u].max_pax,o[u].min_pax,o[u].max_adult,o[u].min_adult,o[u].max_children,o[u].min_children,o[u].max_infant,o[u].min_infant]).draw(!1);y.api().columns.adjust().draw(),e.preventDefault()}),$("#modal-edit :input[name=hotel]").select2({width:"off",ajax:{url:routeHotelSearchActive,type:"POST",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,a){return{results:e}},complete:function(e,a){"419"==e.status&&location.reload(!0)},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:3,templateResult:e,templateSelection:a}),$("#modal-edit :input[name=hotel]").on("select2:select select2:unselect",function(e){var a=e.params.data;if(a.selected){var t=null!=a.country?a.country.name:"",i=null!=a.state?a.state.name:"",d=null!=a.city?a.city.name:"",n=null!=a.hotel_chain?a.hotel_chain.name:"";$("#modal-edit .show-hotel :input[name=hotel-id]").val(a.id),$("#modal-edit .show-hotel :input[name=name]").val(a.name),$("#modal-edit .show-hotel :input[name=country-text]").val(t),$("#modal-edit .show-hotel :input[name=state-text]").val(i),$("#modal-edit .show-hotel :input[name=city-text]").val(d),$("#modal-edit .show-hotel :input[name=postal-code]").val(a.postal_code),$("#modal-edit .show-hotel :input[name=address]").val(a.address),$("#modal-edit .show-hotel :input[name=category]").barrating("readonly",!0);var o=null!=a.category?a.category:"";$("#modal-edit .show-hotel :input[name=category]").barrating("set",o),$("#modal-edit .show-hotel :input[name=hotel-chain]").val(n),$("#modal-edit .show-hotel :input[name=admin-phone]").val(a.admin_phone),$("#modal-edit .show-hotel :input[name=admin-fax]").val(a.admin_fax),$("#modal-edit .show-hotel :input[name=web-site]").val(a.web_site),$("#modal-edit .show-hotel :input[name=turistic-licence]").val(a.turistic_licence),$("#modal-edit .show-hotel :input[name=email]").val(a.email)}}),$("#rate_fee_value_1_edit").TouchSpin({min:-1e9,max:1e9,stepinterval:50,step:.01,decimals:2,maxboostedstep:10,prefix:"$"}),$("#rate_percent_value_1_edit").TouchSpin({min:-100,max:100,step:.01,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#modal-edit :input[name=select-markets]").multiSelect({afterSelect:function(e){var a='<li data-tab="'+e+'">',t='<div class="tab-pane" id="tab_'+e+'_edit" data-tab="'+e+'">';a+='<a href="#tab_'+e+'_edit" data-toggle="tab"> '+$("#modal-edit :input[name=select-markets] option[value="+e+"]").html()+" </a></li>",t+='<div class="row" style="margin-top:15px;"><div class="col-md-5 col-sm-5 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="rate_type_'+e+'" id="rate_type_percent_'+e+'_edit" value="1" data-target="rate_percent_value_'+e+'_edit" data-market="'+e+'" checked><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="" name="rate_percent_value_'+e+'" id="rate_percent_value_'+e+'_edit"/></div><span style="margin-top: 8px;"></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="rate_type_'+e+'" id="rate_type_fee_'+e+'_edit" value="2" data-target="rate_fee_value_'+e+'_edit" data-market="'+e+'"><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="" name="rate_fee_value_'+e+'" id="rate_fee_value_'+e+'_edit" disabled/></div><span style="margin-top: 8px;"></span></label></div></div><div class="col-md-3 col-sm-3 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_edit" id="round_method_1_'+e+'" value="1" data-market="'+e+'" checked> Default Round<span></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_edit" id="round_method_2_'+e+'" value="2" data-market="'+e+'"> Integer Round<span></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_edit" id="round_method_3_'+e+'" value="3" data-market="'+e+'"> Integer Round Up<span></span></label></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class="mt-checkbox-list" style="padding: 0"><label class="mt-checkbox mt-checkbox-outline"><input type="checkbox" name="update_prices_'+e+'_edit" value="1"> Update related prices<span></span></label></div></div></div>',t+="</div>",$("#modal-edit .market-rate-container .custom-tab").append(a),$("#modal-edit .market-rate-container .custom-content").append(t),$("#modal-edit .market-rate-container").show(),$("#rate_fee_value_"+e+"_edit").TouchSpin({min:-1e9,max:1e9,stepinterval:50,step:.01,decimals:2,maxboostedstep:10,prefix:"$"}),$("#rate_percent_value_"+e+"_edit").TouchSpin({min:-100,max:100,step:.01,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#rate_type_percent_"+e+"_edit").change(function(){$("#rate_fee_value_"+e+"_edit").val(""),$("#rate_fee_value_"+e+"_edit").attr("disabled","disabled"),$("#rate_percent_value_"+e+"_edit").removeAttr("disabled")}),$("#rate_type_fee_"+e+"_edit").change(function(){$("#rate_percent_value_"+e+"_edit").val(""),$("#rate_percent_value_"+e+"_edit").attr("disabled","disabled"),$("#rate_fee_value_"+e+"_edit").removeAttr("disabled")})},afterDeselect:function(e){$('#modal-edit [data-tab="'+e+'"]').remove(),$("#modal-edit .nav-tabs li").children("a").first().click()},keepOrder:!0}),$("#table tbody").on("click",".dt-edit",function(e){$("#modal-edit .parent-select-room").html(""),x(M),x(T),D.validate().resetForm(),D[0].reset();var a=w.row($(this).parents("tr")).data();g=a.object;var t=a.object,i=t.hotel,d=t.pax_types,n=t.board_types,o=t.room_types,r=t.measures,l=t.markets,s=null!=i.country?i.country.name:"",c=null!=i.state?i.state.name:"",m=null!=i.city?i.city.name:"",p=null!=i.hotel_chain?i.hotel_chain.name:"";$("#modal-edit .hotel-details").each(function(){$(this).hasClass("hidden")||$(this).addClass("hidden")}),$("#modal-edit :input[name=id]").val(t.id),$("#modal-edit :input[name=hotel-id]").val(i.id),$("#modal-edit .select2-selection__rendered").html(i.name+'<span class="select2-selection__placeholder"></span>'),$("#modal-edit :input[name=name]").val(t.name),$("#modal-edit :input[name=valid-from]").datepicker("setDate",new Date(moment(t.valid_from,"YYYY-MM-DD"))),$("#modal-edit :input[name=valid-to]").datepicker("setDate",new Date(moment(t.valid_to,"YYYY-MM-DD"))),$("#modal-edit :input[name=country-text]").val(s),$("#modal-edit :input[name=state-text]").val(c),$("#modal-edit :input[name=city-text]").val(m),$("#modal-edit :input[name=postal-code]").val(i.postal_code),$("#modal-edit :input[name=address]").val(i.address),$("#modal-edit :input[name=category]").barrating("set",i.category),$("#modal-edit :input[name=hotel-chain]").val(p),$("#modal-edit :input[name=admin-phone]").val(i.admin_phone),$("#modal-edit :input[name=admin-fax]").val(i.admin_fax),$("#modal-edit :input[name=web-site]").val(i.web_site),$("#modal-edit :input[name=turistic-licence]").val(i.turistic_licence),$("#modal-edit :input[name=email]").val(i.email),1==a.active?($("#modal-edit :input[name=active]").prop("checked","checked"),$("#modal-edit :input[name=active]").val(1)):($("#modal-edit :input[name=active]").prop("checked",""),$("#modal-edit :input[name=active]").val(0));for(var u=0;u<r.length;u++)$('#modal-edit [name="check-measures[]"][data="'+r[u].id+'"]').prop("checked","checked");$("#modal-edit :input[name=select-markets]").multiSelect("deselect_all"),$("#modal-edit .ms-elem-selectable").removeClass("ms-hover"),$("#modal-edit [id=rate_fee_value_1_edit]").val(""),$("#modal-edit [id=rate_percent_value_1_edit]").val(""),$("#modal-edit [data-tab]").each(function(){"1"!=$(this).attr("data-tab")&&$(this).remove()}),$("#modal-edit .nav-tabs li").children("a").first().click(),$("#modal-edit [id=rate_type_percent_1_edit]").change(function(){$("#modal-edit [id=rate_fee_value_1_edit]").val(""),$("#modal-edit [id=rate_fee_value_1_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_percent_value_1_edit]").removeAttr("disabled")}),$("#modal-edit [id=rate_type_fee_1_edit]").change(function(){$("#modal-edit [id=rate_percent_value_1_edit]").val(""),$("#modal-edit [id=rate_percent_value_1_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_fee_value_1_edit]").removeAttr("disabled")});for(u=0;u<l.length;u++){var _=l[u].pivot;if(1==l[u].id)"1"==_.type?($("#modal-edit [id=rate_percent_value_1_edit]").val(_.value),$("#modal-edit [id=rate_type_percent_1_edit]").prop("checked","checked"),$("#modal-edit [id=rate_fee_value_1_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_percent_value_1_edit]").removeAttr("disabled")):"2"==_.type&&($("#modal-edit [id=rate_fee_value_1_edit]").val(_.value),$("#modal-edit [id=rate_type_fee_1_edit]").prop("checked","checked"),$("#modal-edit [id=rate_percent_value_1_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_fee_value_1_edit]").removeAttr("disabled")),"1"==_.round?$("#modal-edit [id=round_method_1_1_edit]").prop("checked","checked"):"2"==_.round?$("#modal-edit [id=round_method_2_1_edit]").prop("checked","checked"):"3"==_.round&&$("#modal-edit [id=round_method_3_1_edit]").prop("checked","checked");else{$("#modal-edit :input[name=select-markets]").find("option[value="+l[u].id+"]").prop("selected","selected");var h='<li data-tab="'+l[u].id+'">',v='<div class="tab-pane" id="tab_'+l[u].id+'_edit" data-tab="'+l[u].id+'">';h+='<a href="#tab_'+l[u].id+'_edit" data-toggle="tab"> '+l[u].name+" </a></li>",v+='<div class="row" style="margin-top:15px;"><div class="col-md-5 col-sm-5 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio">',"1"==_.type?v+='<input type="radio" name="rate_type_'+l[u].id+'" id="rate_type_percent_'+l[u].id+'_edit" value="1" data-target="rate_percent_value_'+l[u].id+'_edit" data-market="'+l[u].id+'" checked><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="'+_.value+'" name="rate_percent_value_'+l[u].id+'" id="rate_percent_value_'+l[u].id+'_edit"/></div>':v+='<input type="radio" name="rate_type_'+l[u].id+'" id="rate_type_percent_'+l[u].id+'_edit" value="1" data-target="rate_percent_value_'+l[u].id+'_edit" data-market="'+l[u].id+'"><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="" name="rate_percent_value_'+l[u].id+'" id="rate_percent_value_'+l[u].id+'_edit" disabled/></div>',v+='<span style="margin-top: 8px;"></span></label><label class="mt-radio mt-radio-outline custom-radio">',"2"==_.type?v+='<input type="radio" name="rate_type_'+l[u].id+'" id="rate_type_fee_'+l[u].id+'_edit" value="2" data-target="rate_fee_value_'+l[u].id+'_edit" data-market="'+l[u].id+'" checked><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="'+_.value+'" name="rate_fee_value_'+l[u].id+'" id="rate_fee_value_'+l[u].id+'_edit"/></div>':v+='<input type="radio" name="rate_type_'+l[u].id+'" id="rate_type_fee_'+l[u].id+'_edit" value="2" data-target="rate_fee_value_'+l[u].id+'_edit" data-market="'+l[u].id+'"><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="" name="rate_fee_value_'+l[u].id+'" id="rate_fee_value_'+l[u].id+'_edit" disabled/></div>',v+='<span style="margin-top: 8px;"></span></label></div></div><div class="col-md-3 col-sm-3 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio">',"1"==_.round?v+='<input type="radio" name="round_method_'+l[u].id+'_edit" id="round_method_1_'+l[u].id+'_edit" value="1" data-market="'+l[u].id+'" checked> Default Round':v+='<input type="radio" name="round_method_'+l[u].id+'_edit" id="round_method_1_'+l[u].id+'_edit" value="1" data-market="'+l[u].id+'"> Default Round',v+='<span></span></label><label class="mt-radio mt-radio-outline custom-radio">',"2"==_.round?v+='<input type="radio" name="round_method_'+l[u].id+'_edit" id="round_method_2_'+l[u].id+'_edit" value="2" data-market="'+l[u].id+'" checked> Integer Round':v+='<input type="radio" name="round_method_'+l[u].id+'_edit" id="round_method_2_'+l[u].id+'_edit" value="2" data-market="'+l[u].id+'"> Integer Round',v+='<span></span></label><label class="mt-radio mt-radio-outline custom-radio">',"3"==_.round?v+='<input type="radio" name="round_method_'+l[u].id+'_edit" id="round_method_3_'+l[u].id+'_edit" value="3" data-market="'+l[u].id+'" checked> Integer Round Up':v+='<input type="radio" name="round_method_'+l[u].id+'_edit" id="round_method_3_'+l[u].id+'_edit" value="3" data-market="'+l[u].id+'"> Integer Round Up',v+='<span></span></label></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class="mt-checkbox-list" style="padding: 0"><label class="mt-checkbox mt-checkbox-outline"><input type="checkbox" name="update_prices_'+l[u].id+'_edit" value="1"> Update related prices<span></span></label></div></div></div>',v+="</div>",$("#modal-edit .market-rate-container .custom-tab").append(h),$("#modal-edit .market-rate-container .custom-content").append(v),$("#rate_fee_value_"+l[u].id+"_edit").TouchSpin({min:-1e9,max:1e9,stepinterval:50,step:.01,decimals:2,maxboostedstep:10,prefix:"$"}),$("#rate_percent_value_"+l[u].id+"_edit").TouchSpin({min:-100,max:100,step:.01,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#modal-edit [id=rate_type_percent_"+l[u].id+"_edit]").change(function(){var e=$(this).attr("data-market");$("#modal-edit [id=rate_fee_value_"+e+"_edit]").val(""),$("#modal-edit [id=rate_fee_value_"+e+"_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_percent_value_"+e+"_edit]").removeAttr("disabled")}),$("#modal-edit [id=rate_type_fee_"+l[u].id+"_edit]").change(function(){var e=$(this).attr("data-market");$("#modal-edit [id=rate_percent_value_"+e+"_edit]").val(""),$("#modal-edit [id=rate_percent_value_"+e+"_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_fee_value_"+e+"_edit]").removeAttr("disabled")})}}$("#modal-edit :input[name=select-markets]").multiSelect("refresh");for(u=0;u<d.length;u++)$('tbody > tr > td:nth-child(1) input[type="checkbox"]',T).each(function(){T.api().row($(this).parents("tr")).data()[1]==d[u].id&&$(this).prop("checked","checked")});$("#modal-edit :input[name=count-pax-type]").val(k(T)),T.api().columns.adjust().draw();for(u=0;u<n.length;u++)$('tbody > tr > td:nth-child(1) input[type="checkbox"]',M).each(function(){M.api().row($(this).parents("tr")).data()[1]==n[u].id&&$(this).prop("checked","checked")});$("#modal-edit :input[name=count-board-type]").val(k(M)),M.api().columns.adjust().draw();var f=[],b=[];S.api().clear();for(u=0;u<o.length;u++){var y='<div class="dt-actions"><a class="btn btn-default btn-circle btn-icon-only btn-action dt-pax-type" data="'+o[u].id+'" data-toggle="modal" href="#modal-view-pax-type" style="margin-right: 0"><i class="fa fa-male btn-action-icon"></i></a></div>';S.api().row.add([o[u].id,o[u].code+": "+o[u].name,o[u].max_pax,o[u].min_pax,o[u].max_adult,o[u].min_adult,o[u].max_children,o[u].min_children,o[u].max_infant,o[u].min_infant,y]).draw(!1),b.push({id:o[u].id,code:o[u].code,name:o[u].name}),f.push(o[u].id)}$("#modal-edit :input[name=count-room-type]").val(o.length),S.api().columns.adjust().draw();$("#modal-edit .parent-select-room").append('<label class="control-label">Search Room Type</label><div class="input-group input-group-md select2-bootstrap-append"><select class="form-control js-data-ajax" multiple></select></div>'),$("#modal-edit .js-data-ajax").select2({data:b,width:"off",ajax:{url:routeRoomTypeSearchActive,type:"POST",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,a){return{results:e}},complete:function(e,a){"419"==e.status&&location.reload(!0)},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:3,templateResult:Y,templateSelection:j}),$("#modal-edit .js-data-ajax").on("select2:select select2:unselect",function(e){var i=e.params.data;if(i.selected)S.api().row.add([i.id,i.code+": "+i.name,i.max_pax,i.min_pax,i.max_adult,i.min_adult,i.max_children,i.min_children,i.max_infant,i.min_infant]).draw(!1),S.api().columns.adjust().draw();else{var a=!1,t=$(this).val();if(null!=t)for(var d=0;d<t.length;d++)if(t[d]==i.id){a=!0;break}a||S.api().rows(function(e,a,t){return a[0]==i.id}).remove().draw()}$("#modal-edit :input[name=count-room-type]").val(S.api().rows().count())}),$("#modal-edit .js-data-ajax").val(f).trigger("change"),App.reloadToolTips(),e.preventDefault()});var i=!1;$("#table tbody").on("click",".dt-delete",function(e){if(!i){var a=w.row($(this).parents("tr")).data();$(this).confirmation("show"),$(this).on("confirmed.bs.confirmation",function(){i=!0,$.ajax({url:routeDelete,type:"POST",data:{id:a.id},beforeSend:function(){App.showMask(!0,$("#table"))},complete:function(e,a){if(i=!1,App.showMask(!1,$("#table")),"419"==e.status)location.reload(!0);else if("200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"success"==t.status?(toastr.success(t.message,"Success"),w.draw()):toastr.error(t.message,"Error")}}})})}e.preventDefault()}),$(".cancel-form").on("click",function(e){r&&(w.draw(),r=!1)}),$(".btn-search-reset").on("click",function(e){e.preventDefault(),$("#search-section :input[name=name]").val(""),$("#search-section :input[name=hotel]").val(""),$("#search-section :input[name=active]").val(""),$("#search-section :input[name=valid-from]").val(""),$("#search-section :input[name=valid-to]").val(""),$("#search-section :input[name=location]").val("")}),$(".btn-search-cancel").on("click",function(e){e.preventDefault(),$("#search-section").slideToggle()}),$(".btn-search-submit").on("click",function(e){e.preventDefault(),w.columns("name:name").search($("#search-section :input[name=name]").val()).columns("hotel:name").search($("#search-section :input[name=hotel]").val()).columns("valid_from:name").search($("#search-section :input[name=valid-from]").val()).columns("valid_to:name").search($("#search-section :input[name=valid-to]").val()).columns("active:name").search($("#search-section :input[name=active]").val()).columns("location:name").search($("#search-section :input[name=location]").val()).draw()});var s=$("#modal-add .table-pax-type").dataTable({sDom:"t",autoWidth:!1,columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[3,"asc"]],lengthMenu:[[-1],["All"]]});s.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),a=jQuery(this).is(":checked");jQuery(e).each(function(){a?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))}),$("#modal-add :input[name=count-pax-type]").val(k(s))}),s.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active"),$("#modal-add :input[name=count-pax-type]").val(k(s))});var c=$("#modal-add .table-board-type").dataTable({sDom:"t",columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[2,"asc"]],autoWidth:!1,lengthMenu:[[-1],["All"]]});c.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),a=jQuery(this).is(":checked");jQuery(e).each(function(){a?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))}),$("#modal-add :input[name=count-board-type]").val(k(c))}),c.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active"),$("#modal-add :input[name=count-board-type]").val(k(c))});var m=$("#modal-add .table-market").dataTable({sDom:"t",columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[2,"asc"]],autoWidth:!1,lengthMenu:[[-1],["All"]]});m.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),a=jQuery(this).is(":checked");jQuery(e).each(function(){a?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))})}),m.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active")});var p=$("#modal-add .table-room-type").dataTable({sDom:"tip",lengthMenu:[[-1],["All"]],ordering:!1,autoWidth:!1,columnDefs:[{visible:!1,targets:[0]},{targets:[1],width:"35%"}],language:{emptyTable:"No room type selected"},pageLength:10}),f=$("#modal-info .table-pax-type").dataTable({sDom:"t",columnDefs:[{visible:!1,targets:[0]}],order:[[2,"asc"]],lengthMenu:[[-1],["All"]]}),b=$("#modal-info .table-board-type").dataTable({sDom:"t",columnDefs:[{visible:!1,targets:[0]}],order:[[1,"asc"]],lengthMenu:[[-1],["All"]]}),y=$("#modal-info .table-room-type").dataTable({sDom:"tip",lengthMenu:[[-1],["All"]],order:[[1,"asc"]],autoWidth:!1,columnDefs:[{visible:!1,targets:[0]},{targets:[1],width:"35%"},{orderable:!1,targets:[2]},{orderable:!1,targets:[3]},{orderable:!1,targets:[4]},{orderable:!1,targets:[5]},{orderable:!1,targets:[6]},{orderable:!1,targets:[7]},{orderable:!1,targets:[8]},{orderable:!1,targets:[9]}],language:{emptyTable:"No room type selected"},pageLength:10}),T=$("#modal-edit .table-pax-type").dataTable({sDom:"t",autoWidth:!1,columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[3,"asc"]],lengthMenu:[[-1],["All"]]});T.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),a=jQuery(this).is(":checked");jQuery(e).each(function(){a?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))}),$("#modal-edit :input[name=count-pax-type]").val(k(T))}),T.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active"),$("#modal-edit :input[name=count-pax-type]").val(k(T))});var M=$("#modal-edit .table-board-type").dataTable({sDom:"t",autoWidth:!1,columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[2,"asc"]],lengthMenu:[[-1],["All"]]});M.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),a=jQuery(this).is(":checked");jQuery(e).each(function(){a?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))}),$("#modal-edit :input[name=count-board-type]").val(k(M))}),M.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active"),$("#modal-edit :input[name=count-board-type]").val(k(M))});var t=$("#modal-edit .table-measure").dataTable({sDom:"t",autoWidth:!1,columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[2,"asc"]],lengthMenu:[[-1],["All"]]});t.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),a=jQuery(this).is(":checked");jQuery(e).each(function(){a?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))}),$("#modal-edit :input[name=count-measure]").val(k(t))}),t.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active"),$("#modal-edit :input[name=count-measure]").val(k(t))});var S=$("#modal-edit .table-room-type").dataTable({sDom:"tip",lengthMenu:[[-1],["All"]],ordering:!1,autoWidth:!1,columnDefs:[{visible:!1,targets:[0]},{width:"35%",targets:[1]},{className:"dt-center",targets:[10]}],language:{emptyTable:"No room type selected"},pageLength:10});function Y(e){return e.loading?e.text:"<div class=''><div class=''>"+e.code+": "+e.name+" (Max Pax: "+e.max_pax+", Min Pax: "+e.min_pax+", Max AD: "+e.max_adult+", Min AD: "+e.min_adult+", Max CH: "+e.max_children+", Min CH: "+e.min_children+", Max INF: "+e.max_infant+", Min INF: "+e.min_infant+")</div></div>"}function j(e){return e.code+": "+e.name}function e(e){return e.loading?e.text:"<div class=''><div class=''>"+e.name+"</div></div>"}function a(e){return e.name}$("#modal-add :input[name=hotel]").select2({width:"off",ajax:{url:routeHotelSearchActive,type:"POST",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,a){return{results:e}},complete:function(e,a){"419"==e.status&&location.reload(!0)},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:3,templateResult:e,templateSelection:a}),$("#modal-add :input[name=hotel]").on("select2:select select2:unselect",function(e){var a=e.params.data;if(a.selected){var t=null!=a.country?a.country.name:"",i=null!=a.state?a.state.name:"",d=null!=a.city?a.city.name:"",n=null!=a.hotel_chain?a.hotel_chain.name:"";$("#modal-add .show-hotel :input[name=hotel-id]").val(a.id),$("#modal-add .show-hotel :input[name=name]").val(a.name),$("#modal-add .show-hotel :input[name=country-text]").val(t),$("#modal-add .show-hotel :input[name=state-text]").val(i),$("#modal-add .show-hotel :input[name=city-text]").val(d),$("#modal-add .show-hotel :input[name=postal-code]").val(a.postal_code),$("#modal-add .show-hotel :input[name=address]").val(a.address),$("#modal-add .show-hotel :input[name=category]").barrating("readonly",!0);var o=null!=a.category?a.category:"";$("#modal-add .show-hotel :input[name=category]").barrating("set",o),$("#modal-add .show-hotel :input[name=hotel-chain]").val(n),$("#modal-add .show-hotel :input[name=admin-phone]").val(a.admin_phone),$("#modal-add .show-hotel :input[name=admin-fax]").val(a.admin_fax),$("#modal-add .show-hotel :input[name=web-site]").val(a.web_site),$("#modal-add .show-hotel :input[name=turistic-licence]").val(a.turistic_licence),$("#modal-add .show-hotel :input[name=email]").val(a.email)}}),$("#modal-add .js-data-ajax").select2({width:"off",ajax:{url:routeRoomTypeSearchActive,type:"POST",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,a){return{results:e}},complete:function(e,a){"419"==e.status&&location.reload(!0)},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:3,templateResult:Y,templateSelection:j}),$("#modal-add .js-data-ajax").on("select2:select select2:unselect",function(e){var i=e.params.data;if(i.selected)p.api().row.add([i.id,i.code+": "+i.name,i.max_pax,i.min_pax,i.max_adult,i.min_adult,i.max_children,i.min_children,i.max_infant,i.min_infant]).draw(!1),p.api().columns.adjust().draw();else{var a=!1,t=$(this).val();if(null!=t)for(var d=0;d<t.length;d++)if(t[d]==i.id){a=!0;break}a||p.api().rows(function(e,a,t){return a[0]==i.id}).remove().draw()}$("#modal-add :input[name=count-room-type]").val(p.api().rows().count())}),$("button[data-select2-open]").click(function(){$("#"+$(this).data("select2-open")).select2("open")}),$(".excel").on("click",function(){var e={name:$("#search-section :input[name=name]").val(),hotel:$("#search-section :input[name=hotel]").val(),location:$("#search-section :input[name=location]").val(),validFrom:$("#search-section :input[name=valid-from]").val(),validTo:$("#search-section :input[name=valid-to]").val(),active:$("#search-section :input[name=active]").val()},a=routeExcel+"?"+$.param(e);window.location=a});var d=!1;$("#table tbody").on("click",".dt-duplicate",function(e){if(!d){var a=w.row($(this).parents("tr")).data();$(this).confirmation("show"),$(this).on("confirmed.bs.confirmation",function(){d=!0,$.ajax({url:routeDuplicate,type:"POST",data:{id:a.id},beforeSend:function(){App.showMask(!0,$("#table"))},complete:function(e,a){if(d=!1,App.showMask(!1,$("#table")),"419"==e.status)location.reload(!0);else if("200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"success"==t.status?(toastr.success(t.message,"Success"),w.draw()):toastr.error(t.message,"Error")}}})})}e.preventDefault()});var u=$("#table-view-pax-type").dataTable({sDom:"tip",autoWidth:!1,columnDefs:[{visible:!1,targets:[0]},{className:"dt-center",orderable:!1,targets:[6]},{visible:!1,targets:[7]}],order:[[2,"asc"]],lengthMenu:[[-1],["All"]],pageLength:100});$("#modal-edit .table-room-type tbody").on("click",".dt-pax-type",function(e){e.preventDefault(),u.api().clear();var a=S.api().row($(this).parents("tr")).data()[1];$("#modal-view-pax-type .custom-header").html(a);var t=$(this).attr("data");$.ajax({url:routeRoomPaxTypes,type:"POST",data:{contractId:g.id,roomTypeId:t},beforeSend:function(){App.showMask(!0,$("#table-view-pax-type"))},complete:function(e,a){if(App.showMask(!1,$("#table-view-pax-type")),"419"==e.status)location.reload(!0);else if("200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);if("success"==t.status){for(var i=t.data,d=0;d<i.length;d++){var n="";1==i[d].type?n="Infant":2==i[d].type?n="Children":3==i[d].type&&(n="Adult");var o=i[d].contract_pax_types[0].room_pax_type_relations[0],r=o.id,l='<input class="active-selector" type="checkbox" name="active" data="'+r+'"';1==o.active&&(l+=" checked "),l+=">",u.api().row.add([i[d].id,i[d].code,i[d].name,n,i[d].agefrom,i[d].ageto,l,r]).draw(!1),$(".active-selector[data="+r+"]").bootstrapSwitch({size:"mini",onColor:"success",offColor:"danger"})}u.api().columns.adjust().draw();var s=!1;$(".active-selector").on("switchChange.bootstrapSwitch",function(e,a){var i=$(this).attr("data");s||(s=!0,$.ajax({url:routeUpdateRoomPaxTypes,type:"POST",data:{relationId:i,active:a},beforeSend:function(){App.showMask(!0,$("#table-view-pax-type"))},complete:function(e,a){if(App.showMask(!1,$("#table-view-pax-type")),"419"==e.status)location.reload(!0);else if("200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content"),s=!1;else{var t=$.parseJSON(e.responseText);"error"==t.status&&(toastr.error(t.message,"Error"),$(".active-selector[data="+i+"]").bootstrapSwitch("toggleState")),s=!1}}}))})}else"warning"==t.status?toastr.warning(t.message,"Warning"):toastr.error(t.message,"Error")}}})})});