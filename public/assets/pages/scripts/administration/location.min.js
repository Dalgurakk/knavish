function cleanLocationSelected(){$("#node-data :input[name=name]").val(""),$("#node-data :input[name=code]").val(""),$("#node-data :input[name=active]").prop("checked",""),$("#node-data :input[name=active]").val(0),$("#node-data").find("div[name=icon] > i").attr("class","glyphicon glyphicon-question-sign"),$(".edit-node").addClass("disabled"),$(".delete-node").addClass("disabled")}$(document).ready(function(){var n="0",r=!1,e=$(".porlet-data").css("height");function a(){swal({title:"Confirmation",text:'Are you sure you want to delete the location: "'+$("#node-data :input[name=name]").val()+'"?',type:null,allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!0,confirmButtonClass:"green",cancelButtonClass:"red",closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"Accept",cancelButtonText:"Cancel"},function(e){e&&("0"==n?toastr.error("Please select the node you want to delete.","Error"):$.ajax({url:routeDelete,type:"POST",data:{id:n},beforeSend:function(){App.showMask(!0,$(".node-data"))},complete:function(e,t){if(App.showMask(!1,$(".node-data")),"419"==e.status)location.reload(!0);else if("200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var a=$.parseJSON(e.responseText);"success"==a.status?(n="0",toastr.success(a.message,"Success"),$("#tree").jstree("refresh"),cleanLocationSelected()):toastr.error(a.message,"Error")}}}))})}function o(){c.validate().resetForm(),c[0].reset(),$("#modal-add .icon-picker").iconpicker("setIcon","glyphicon-question-sign"),$("#modal-add :input[name=parent-id]").val(n),$("#modal-add").modal("show")}function i(){var e=$("#node-data").find("div[name=icon] > i").attr("class").split(" "),t=$("#node-data :input[name=active]").prop("checked")?1:0;$("#modal-edit :input[name=id]").val(n),$("#modal-edit :input[name=name]").val($("#node-data :input[name=name]").val()),$("#modal-edit :input[name=code]").val($("#node-data :input[name=code]").val()),$("#modal-edit :input[name=icon]").val(e[1]),$("#modal-edit .icon-picker").iconpicker("setIcon",e[1]),1==t?($("#modal-edit :input[name=active]").prop("checked","checked"),$("#modal-edit :input[name=active]").val(1)):($("#modal-edit :input[name=active]").prop("checked",""),$("#modal-edit :input[name=active]").val(0)),$("#modal-edit").modal("show")}$(".porlet-tree").css("min-height",e),$(".expand").on("click",function(){"true"==$("#tree-container").attr("data-expanded")?($("#tree-container").animate({width:"66.66%"},500,function(){$("#node-data").fadeIn("slow")}),$("#tree-container").attr("data-expanded","false")):($("#tree-container").animate({width:"100%"},500),$("#node-data").css("display","none"),$("#tree-container").attr("data-expanded","true"))}),$("#modal-add .icon-picker").iconpicker({placement:"bottom",icon:"glyphicon-globe"}),$("#modal-edit .icon-picker").iconpicker({placement:"bottom",icon:"glyphicon-globe"}),$("#modal-add .icon-picker").on("change",function(e){$("#modal-add :input[name=icon]").val(e.icon)}),$("#modal-edit .icon-picker").on("change",function(e){$("#modal-edit :input[name=icon]").val(e.icon)}),$("#tree").on("changed.jstree",function(e,t){if(t.selected.length){var a=t.instance.get_node(t.selected[0]).data;n=a.id,$("#node-data :input[name=obj]").val(a),$("#node-data :input[name=name]").val(a.name),$("#node-data :input[name=code]").val(a.code),$("#node-data").find("div[name=icon] > i").attr("class",a.icon),1==a.active?($("#node-data :input[name=active]").prop("checked","checked"),$("#node-data :input[name=active]").val(1)):($("#node-data :input[name=active]").prop("checked",""),$("#node-data :input[name=active]").val(0)),$(".edit-node").removeClass("disabled"),$(".delete-node").removeClass("disabled")}}).jstree({core:{data:{type:"POST",dataType:"json",url:routeRead,data:function(e){return{id:e.id}}}},contextmenu:{items:{remove:!1,add:{label:"Add",icon:"fa fa-plus",action:function(e,t){o()},separator_before:!0,separator_after:!0},edit:{label:"Edit",icon:"fa fa-pencil",action:function(e,t){i()},separator_before:!0,separator_after:!0},delete:{label:"Delete",icon:"fa fa-trash",action:function(e,t){a()},separator_before:!0,separator_after:!0}}},plugins:["contextmenu"]}),$(".node-option").on("click",function(e){var t=$(this).attr("data");"root"==t?($("#modal-add :input[name=parent-id]").val("0"),$("#modal-add").modal("show")):"node"==t&&("0"==n?toastr.error("Please select a parent.","Error"):o()),e.preventDefault()}),$(".edit-node").on("click",function(e){"0"!=n&&i(),e.preventDefault()}),$(".delete-node").click(function(){"0"!=n&&a()});var c=$("#form-add");c.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{required:!0}},errorPlacement:function(e,t){0<t.parents(".mt-radio-list").size()||0<t.parents(".mt-checkbox-list").size()?(0<t.parents(".mt-radio-list").size()&&e.appendTo(t.parents(".mt-radio-list")[0]),0<t.parents(".mt-checkbox-list").size()&&e.appendTo(t.parents(".mt-checkbox-list")[0])):0<t.parents(".mt-radio-inline").size()||0<t.parents(".mt-checkbox-inline").size()?(0<t.parents(".mt-radio-inline").size()&&e.appendTo(t.parents(".mt-radio-inline")[0]),0<t.parents(".mt-checkbox-inline").size()&&e.appendTo(t.parents(".mt-checkbox-inline")[0])):0<t.parent(".input-group").size()?e.insertAfter(t.parent(".input-group")):t.attr("data-error-container")?e.appendTo(t.attr("data-error-container")):e.insertAfter(t)},invalidHandler:function(e,t){toastr.error("Please check the entry fields.","Error")},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error")},submitHandler:function(n){var o=$(n).find("button[type=submit]:focus").attr("data");$.ajax({url:routeCreate,type:"POST",data:c.serialize(),beforeSend:function(){App.showMask(!0,c)},complete:function(e,t){if(App.showMask(!1,c),"419"==e.status)location.reload(!0);else if("200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var a=$.parseJSON(e.responseText);"success"==a.status?(r=!0,toastr.success(a.message,"Success"),c[0].reset(),r=!0,"accept"==o&&$(n).find("button.cancel-form").click()):toastr.error(a.message,"Error")}}})}});var s=$("#form-edit");s.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{required:!0}},errorPlacement:function(e,t){0<t.parents(".mt-radio-list").size()||0<t.parents(".mt-checkbox-list").size()?(0<t.parents(".mt-radio-list").size()&&e.appendTo(t.parents(".mt-radio-list")[0]),0<t.parents(".mt-checkbox-list").size()&&e.appendTo(t.parents(".mt-checkbox-list")[0])):0<t.parents(".mt-radio-inline").size()||0<t.parents(".mt-checkbox-inline").size()?(0<t.parents(".mt-radio-inline").size()&&e.appendTo(t.parents(".mt-radio-inline")[0]),0<t.parents(".mt-checkbox-inline").size()&&e.appendTo(t.parents(".mt-checkbox-inline")[0])):0<t.parent(".input-group").size()?e.insertAfter(t.parent(".input-group")):t.attr("data-error-container")?e.appendTo(t.attr("data-error-container")):e.insertAfter(t)},invalidHandler:function(e,t){toastr.error("Please check the entry fields.","Error")},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error")},submitHandler:function(n){var o=$(n).find("button[type=submit]:focus").attr("data");$.ajax({url:routeUpdate,type:"POST",data:s.serialize(),beforeSend:function(){App.showMask(!0,s)},complete:function(e,t){if(App.showMask(!1,s),"419"==e.status)location.reload(!0);else if("200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var a=$.parseJSON(e.responseText);"success"==a.status?(r=!0,toastr.success(a.message,"Success"),c[0].reset(),r=!0,"accept"==o&&$(n).find("button.cancel-form").click()):toastr.error(a.message,"Error")}}})}}),$(".cancel-form").on("click",function(e){r&&($("#tree").jstree("refresh"),r=!1)}),$(".mt-checkbox").change(function(){$(".mt-checkbox > input[type=checkbox]").is(":checked")?$(".mt-checkbox > input[type=checkbox]").val(1):$(".mt-checkbox > input[type=checkbox]").val(0)}),$(".add").on("click",function(){c.validate().resetForm(),c[0].reset()}),$(".excel").on("click",function(){var e=routeExcel;window.location=e})});