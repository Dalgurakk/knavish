$(document).ready(function(){$.fn.dataTable.ext.errMode="none";var u=$("#table").on("error.dt",function(a,e,t,n){}).on("processing.dt",function(a,e,t){App.showMask(t,$(this)),App.reloadToolTips()}).on("init.dt",function(){}).DataTable({processing:!0,serverSide:!0,sDom:"ltip",iDisplayLength:10,ajax:{url:routeRead,type:"POST",complete:function(a,e){"200"!=a.status&&toastr.error("Please check your connection and try again.","Error on loading the content"),$(".br-readonly").on("click",function(a){a.preventDefault()})}},order:[[1,"asc"]],columns:[{data:"id",name:"id",visible:!1},{data:"name",name:"name"},{data:"hotel",name:"hotel"},{data:"valid_from",name:"valid_from"},{data:"valid_to",name:"valid_to"},{data:"status",name:"status",orderable:!1,data:function(a,e,t,n){var o="";return"3"==a.status?o='<span class="label label-sm label-danger"> Finished </span>':"2"==a.status?o='<span class="label label-sm label-success"> In Progress </span>':"1"==a.status&&(o='<span class="label label-sm label-warning"> Pending </span>'),o}},{targets:"actions",orderable:!1,name:"actions",className:"dt-center",data:function(a,e,t,n){return'<form method="get" action="'+routeSetting+'"><input type="hidden" name="id" value="'+a.id+'"><div class="dt-actions"><a class="btn btn-default btn-circle btn-icon-only btn-action dt-view" data-toggle="modal" href="#modal-info"><i class="glyphicon glyphicon-eye-open btn-action-icon"></i></a><button type="submit" class="btn btn-default btn-circle btn-icon-only btn-action dt-setting"><i class="icon-settings btn-action-icon"></i></button></div></form>'}}]});$("#table_length").hide(),$(".search").on("click",function(a){$("#search-section").slideToggle()}),$(".reload").on("click",function(a){u.draw()}),$(".lenght-option").on("click",function(){var a=$(this).attr("data");$(this).parent().parent().prev("a").text(a);var e=$("select[name=table_length]");e.val(a),e.change()}),$(".btn-search-reset").on("click",function(a){a.preventDefault(),$("#search-section :input[name=name]").val(""),$("#search-section :input[name=hotel]").val(""),$("#search-section :input[name=valid-from]").val(""),$("#search-section :input[name=valid-to]").val("")}),$(".btn-search-submit").on("click",function(a){a.preventDefault(),u.columns("name:name").search($("#search-section :input[name=name]").val()).columns("hotel:name").search($("#search-section :input[name=hotel]").val()).columns("valid_from:name").search($("#search-section :input[name=valid-from]").val()).columns("valid_to:name").search($("#search-section :input[name=valid-to]").val()).draw()}),$(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"dd.mm.yyyy",orientation:"bottom"});var p=$("#modal-info .table-pax-type").dataTable({sDom:"t",columnDefs:[{visible:!1,targets:[0]}],order:[[2,"asc"]],lengthMenu:[[-1],["All"]]}),v=$("#modal-info .table-board-type").dataTable({sDom:"t",columnDefs:[{visible:!1,targets:[0]}],order:[[1,"asc"]],lengthMenu:[[-1],["All"]]}),f=$("#modal-info .table-room-type").dataTable({sDom:"t",lengthMenu:[[-1],["All"]],order:[[1,"asc"]],autoWidth:!1,columnDefs:[{visible:!1,targets:[0]},{targets:[1],width:"35%"},{orderable:!1,targets:[2]},{orderable:!1,targets:[3]},{orderable:!1,targets:[4]},{orderable:!1,targets:[5]},{orderable:!1,targets:[6]},{orderable:!1,targets:[7]},{orderable:!1,targets:[8]}]});$(".hotel-category").barrating({theme:"fontawesome-stars",readonly:!0}),$("#table tbody").on("click",".dt-view",function(a){var e=u.row($(this).parents("tr")).data().contract,t=e.hotel_contract,n=t.hotel,o=t.pax_types,i=t.board_types,l=t.room_types,r=null!=n.country?n.country.name:"",s=null!=n.state?n.state.name:"",c=null!=n.city?n.city.name:"",d=null!=n.hotel_chain?n.hotel_chain.name:"";$("#modal-info :input[name=name]").val(e.name),$("#modal-info :input[name=contract]").val(t.name),$("#modal-info :input[name=valid-from]").val(moment(t.valid_from,"YYYY-MM-DD").format("DD.MM.YYYY")),$("#modal-info :input[name=valid-to]").val(moment(t.valid_to,"YYYY-MM-DD").format("DD.MM.YYYY")),$("#modal-info :input[name=hotel]").val(n.name),$("#modal-info :input[name=country-text]").val(r),$("#modal-info :input[name=state-text]").val(s),$("#modal-info :input[name=city-text]").val(c),$("#modal-info :input[name=postal-code]").val(n.postal_code),$("#modal-info :input[name=address]").val(n.address),$("#modal-info :input[name=category]").barrating("set",n.category),$("#modal-info :input[name=hotel-chain]").val(d),$("#modal-info :input[name=admin-phone]").val(n.admin_phone),$("#modal-info :input[name=admin-fax]").val(n.admin_fax),$("#modal-info :input[name=web-site]").val(n.web_site),$("#modal-info :input[name=turistic-licence]").val(n.turistic_licence),$("#modal-info :input[name=email]").val(n.email),p.api().clear();for(var m=0;m<o.length;m++)p.api().row.add([o[m].id,o[m].code+": "+o[m].name,o[m].agefrom,o[m].ageto]).draw(!1);p.api().columns.adjust().draw(),v.api().clear();for(m=0;m<i.length;m++)v.api().row.add([i[m].id,i[m].code+": "+i[m].name]).draw(!1);v.api().columns.adjust().draw(),f.api().clear();for(m=0;m<l.length;m++)f.api().row.add([l[m].id,l[m].code+": "+l[m].name,l[m].max_pax,l[m].max_adult,l[m].min_adult,l[m].max_children,l[m].min_children,l[m].max_infant,l[m].min_infant]).draw(!1);f.api().columns.adjust().draw(),a.preventDefault()}),$(".excel").on("click",function(){var a={name:$("#search-section :input[name=name]").val(),hotel:$("#search-section :input[name=hotel]").val(),validFrom:$("#search-section :input[name=valid-from]").val(),validTo:$("#search-section :input[name=valid-to]").val(),active:$("#search-section :input[name=active]").val()},e=routeExcel+"?"+$.param(a);window.location=e})});