$(document).ready(function(){var e=!1;function a(e){return $('tbody > tr > td:nth-child(1) input[type="checkbox"]:checked',e).size()}function t(e){var a=[];return $('tbody > tr > td:nth-child(1) input[type="checkbox"]:checked',e).each(function(){var t=e.api().row($(this).parents("tr")).data();a.push(t[1])}),a}function d(e){$("tbody > tr",e).each(function(){$(this).removeClass("active")})}$("#modal-add [id=rate_fee_value_1_add]").TouchSpin({min:-1e9,max:1e9,stepinterval:50,decimals:2,maxboostedstep:1e7,prefix:"$"}),$("#modal-add [id=rate_percent_value_1_add]").TouchSpin({min:0,max:100,step:1,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#modal-add [id=rate_type_percent_1_add]").change(function(){$("#modal-add [id=rate_fee_value_1_add]").val(""),$("#modal-add [id=rate_fee_value_1_add]").attr("disabled","disabled"),$("#modal-add [id=rate_percent_value_1_add]").removeAttr("disabled")}),$("#modal-add [id=rate_type_fee_1_add]").change(function(){$("#modal-add [id=rate_percent_value_1_add]").val(""),$("#modal-add [id=rate_percent_value_1_add]").attr("disabled","disabled"),$("#modal-add [id=rate_fee_value_1_add]").removeAttr("disabled")}),$("#modal-add :input[name=select-markets]").multiSelect({afterSelect:function(e){var a='<li data-tab="'+e+'">',t='<div class="tab-pane" id="tab_'+e+'_add" data-tab="'+e+'">';a+='<a href="#tab_'+e+'_add" data-toggle="tab"> '+$("#modal-add :input[name=select-markets] option[value="+e+"]").html()+" </a></li>",t+='<div class="row" style="margin-top:15px;"><div class="col-md-6 col-sm-6 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="rate_type_'+e+'" id="rate_type_percent_'+e+'_add" value="1" data-target="rate_percent_value_'+e+'_add" data-market="'+e+'" checked><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="" name="rate_percent_value_'+e+'" id="rate_percent_value_'+e+'_add"/></div><span style="margin-top: 8px;"></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="rate_type_'+e+'" id="rate_type_fee_'+e+'_add" value="2" data-target="rate_fee_value_'+e+'_add" data-market="'+e+'"><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="" name="rate_fee_value_'+e+'" id="rate_fee_value_'+e+'_add" disabled/></div><span style="margin-top: 8px;"></span></label></div></div><div class="col-md-6 col-sm-6 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_add" id="round_method_1_'+e+'" value="1" data-market="'+e+'" checked> Default Round<span></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_add" id="round_method_2_'+e+'" value="2" data-market="'+e+'"> Integer Round<span></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_add" id="round_method_3_'+e+'" value="3" data-market="'+e+'"> Integer Round Up<span></span></label></div></div></div>',t+="</div>",$("#modal-add .market-rate-container .custom-tab").append(a),$("#modal-add .market-rate-container .custom-content").append(t),$("#modal-add .market-rate-container").show(),$("#rate_fee_value_"+e+"_add").TouchSpin({min:-1e9,max:1e9,stepinterval:50,decimals:2,maxboostedstep:1e7,prefix:"$"}),$("#rate_percent_value_"+e+"_add").TouchSpin({min:0,max:100,step:1,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#rate_type_percent_"+e+"_add").change(function(){$("#rate_fee_value_"+e+"_add").val(""),$("#rate_fee_value_"+e+"_add").attr("disabled","disabled"),$("#rate_percent_value_"+e+"_add").removeAttr("disabled")}),$("#rate_type_fee_"+e+"_add").change(function(){$("#rate_percent_value_"+e+"_add").val(""),$("#rate_percent_value_"+e+"_add").attr("disabled","disabled"),$("#rate_fee_value_"+e+"_add").removeAttr("disabled")})},afterDeselect:function(e){$('#modal-add [data-tab="'+e+'"]').remove(),$("#modal-add .nav-tabs li").children("a").first().click()},keepOrder:!0}),$(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"dd.mm.yyyy",orientation:"bottom"}),$("#search-section :input[name=valid-from]").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"dd.mm.yyyy",orientation:"bottom"}),$("#search-section :input[name=valid-to]").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"dd.mm.yyyy",orientation:"bottom"}),$(".hotel-category").barrating({theme:"fontawesome-stars"}),$("#modal-add .toggle-hotel").on("click",function(){$("#modal-add .show-hotel").slideToggle()}),$("#modal-add :input[name=category]").barrating("readonly",!0),$("#modal-info :input[name=category]").barrating("readonly",!0),$("#modal-edit :input[name=category]").barrating("readonly",!0),$.fn.dataTable.ext.errMode="none";var i=$("#table").on("error.dt",function(e,a,t,d){}).on("processing.dt",function(e,a,t){App.showMask(t,$(this)),App.reloadToolTips()}).on("init.dt",function(){}).DataTable({processing:!0,serverSide:!0,sDom:"ltip",iDisplayLength:10,ajax:{url:routeRead,type:"POST",complete:function(e,a){"200"!=e.status&&toastr.error("Please check your connection and try again.","Error on loading the content"),$(".br-readonly").on("click",function(e){e.preventDefault()})}},order:[[1,"asc"]],columns:[{data:"id",name:"id",visible:!1},{data:"name",name:"name"},{data:"hotel",name:"hotel",orderable:!1},{data:"valid_from",name:"valid_from"},{data:"valid_to",name:"valid_to"},{data:"status",name:"status",orderable:!1,data:function(e,a,t,d){var i="";return"3"==e.status?i='<span class="label label-sm label-danger"> Finished </span>':"2"==e.status?i='<span class="label label-sm label-success"> In Progress </span>':"1"==e.status&&(i='<span class="label label-sm label-warning"> Pending </span>'),i}},{data:"active",name:"active",className:"dt-center",data:function(e,a,t,d){var i='<span><i class="fa fa-close dt-active dt-active-0"></i></span>';return 1==e.active&&(i='<span><i class="fa fa-check dt-active dt-active-1"></i></span>'),i}},{targets:"actions",orderable:!1,name:"actions",className:"dt-center",data:function(e,a,t,d){return'<form method="get" action="'+routeSetting+'"><input type="hidden" name="id" value="'+e.id+'"><div class="dt-actions"><a class="btn btn-default btn-circle btn-icon-only btn-action dt-view" data-toggle="modal" href="#modal-info"><i class="glyphicon glyphicon-eye-open btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-edit" data-toggle="modal" href="#modal-edit"><i class="icon-pencil btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-delete" href="javascript:;" data-popout="true" data-placement="left"data-btn-ok-label="Yes" data-btn-ok-class="btn-sm btn-success"  data-btn-ok-icon-content="check" data-btn-cancel-label="No" data-btn-cancel-class="btn-sm btn-danger" data-btn-cancel-icon-content="close" data-title="Are you sure?" data-content=""><i class="icon-trash btn-action-icon"></i></a><button type="submit" class="btn btn-default btn-circle btn-icon-only btn-action dt-setting"><i class="icon-settings btn-action-icon"></i></button></div></form>'}}]});$("#table_length").hide(),$(".search").on("click",function(e){$("#search-section").slideToggle()}),$(".reload").on("click",function(e){i.draw()}),$(".add").on("click",function(){n.validate().resetForm(),n[0].reset(),$("#modal-add :input[name=category]").barrating("set",""),$("#modal-add .date-picker").datepicker("clearDates"),c.api().clear().draw(),$("#modal-add .js-data-ajax").val(null).trigger("change"),$("#modal-add .select-hotel").val(null).trigger("change"),d(l),d(r),d(s),$("#modal-add :input[name=select-markets]").multiSelect("deselect_all"),$("#modal-add [data-tab]").each(function(){"1"!=$(this).attr("data-tab")&&$(this).remove()}),$("#modal-add .ms-elem-selectable").removeClass("ms-hover")}),$(".lenght-option").on("click",function(){var e=$(this).attr("data");$(this).parent().parent().prev("a").text(e);var a=$("select[name=table_length]");a.val(e),a.change()}),$.validator.addMethod("greaterThanZero",function(e,a,t){return this.optional(a)||parseInt(e)>0},"At least one element is required."),jQuery.validator.addMethod("validDate",function(e,a){return this.optional(a)||moment(e,"DD.MM.YYYY",!0).isValid()},"Invalid date, use dd.mm.yyyy."),$.validator.addMethod("validMarketPriceRate",function(e,a,t){var d=!0;return $('#modal-add [name^="rate_type_"]').each(function(){if($(this).prop("checked")){var e=$(this).attr("data-target"),a=$("#"+e).val();if(""==a||null==a)return d=!1,!1}}),d},"Some market rate price is invalid.");var n=$("#form-add");n.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{required:!0},hotel:{required:!0},status:{required:!0},"valid-from":{required:!0,validDate:!0},"valid-to":{required:!0,validDate:!0},"count-board-type":{greaterThanZero:!0},"count-pax-type":{greaterThanZero:!0},"count-room-type":{greaterThanZero:!0},"market-rate-price":{validMarketPriceRate:!0}},errorPlacement:function(e,a){a.parents(".mt-radio-list").size()>0||a.parents(".mt-checkbox-list").size()>0?(a.parents(".mt-radio-list").size()>0&&e.appendTo(a.parents(".mt-radio-list")[0]),a.parents(".mt-checkbox-list").size()>0&&e.appendTo(a.parents(".mt-checkbox-list")[0])):a.parents(".mt-radio-inline").size()>0||a.parents(".mt-checkbox-inline").size()>0?(a.parents(".mt-radio-inline").size()>0&&e.appendTo(a.parents(".mt-radio-inline")[0]),a.parents(".mt-checkbox-inline").size()>0&&e.appendTo(a.parents(".mt-checkbox-inline")[0])):a.parent(".input-group").size()>0?e.insertAfter(a.parent(".input-group")):a.attr("data-error-container")?e.appendTo(a.attr("data-error-container")):a.hasClass("hotel-category")?e.insertAfter(a.next()):a.hasClass("hotel-type")?e.insertAfter(a.next()):a.hasClass("select-hotel")?e.insertAfter(a.next()):a.hasClass("market-rate-price-type")?(e.appendTo(".market-rate-container-error"),$(".market-rate-container-error > span").css("color","#e73d4a")):e.insertAfter(a)},invalidHandler:function(e,a){toastr.error("Please check the entry fields.","Error")},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error")},submitHandler:function(a){var i=$(a).find("button[type=submit]:focus").attr("data"),o=new FormData(n[0]),m=[];$('#modal-add [name="check-measures[]"]').each(function(){$(this).prop("checked")&&m.push($(this).attr("data"))});var p=[];$('#modal-add [name^="rate_type_"]:checked').each(function(){var e=$(this).attr("data-target"),a=$(this).attr("data-market"),t=$("#"+e).val(),d=$('#modal-add :input[name="round_method_'+a+'_add"]:checked').val(),i={market_id:a,rate_type:$(this).val(),value:t,round_type:d};p.push(i)}),o.append("paxTypes",JSON.stringify(t(r))),o.append("boardTypes",JSON.stringify(t(l))),o.append("markets",JSON.stringify(t(s))),o.append("roomTypes",JSON.stringify($("#modal-add .js-data-ajax").val())),o.append("measures",JSON.stringify(m)),o.append("markets",JSON.stringify(p)),$.ajax({url:routeCreate,type:"POST",data:o,contentType:!1,processData:!1,beforeSend:function(){App.showMask(!0,n)},complete:function(t,o){if(App.showMask(!1,n),"200"!=t.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var m=$.parseJSON(t.responseText);"success"==m.status?(toastr.success(m.message,"Success"),n[0].reset(),e=!0,"accept"==i&&$(a).find("button.cancel-form").click(),c.api().clear().draw(),$("#modal-add .js-data-ajax").val(null).trigger("change"),$("#modal-add .select-hotel").val(null).trigger("change"),d(l),d(r),d(s)):toastr.error(m.message,"Error")}}})}}),$(".mt-checkbox").change(function(){$(".mt-checkbox > input[type=checkbox]").is(":checked")?$(".mt-checkbox > input[type=checkbox]").val(1):$(".mt-checkbox > input[type=checkbox]").val(0)}),$.validator.addMethod("validMarketPriceRate2",function(e,a,t){var d=!0;return $('#modal-edit [name^="rate_type_"]').each(function(){if($(this).prop("checked")){var e=$(this).attr("data-target"),a=$("#"+e).val();if(""==a||null==a)return d=!1,!1}}),d},"Some market rate price is invalid.");var o=$("#form-edit");o.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{required:!0},"hotel-id":{required:!0},status:{required:!0},"valid-from":{required:!0,validDate:!0},"valid-to":{required:!0,validDate:!0},"count-board-type":{greaterThanZero:!0},"count-pax-type":{greaterThanZero:!0},"count-room-type":{greaterThanZero:!0},"market-rate-price":{validMarketPriceRate2:!0}},errorPlacement:function(e,a){a.parents(".mt-radio-list").size()>0||a.parents(".mt-checkbox-list").size()>0?(a.parents(".mt-radio-list").size()>0&&e.appendTo(a.parents(".mt-radio-list")[0]),a.parents(".mt-checkbox-list").size()>0&&e.appendTo(a.parents(".mt-checkbox-list")[0])):a.parents(".mt-radio-inline").size()>0||a.parents(".mt-checkbox-inline").size()>0?(a.parents(".mt-radio-inline").size()>0&&e.appendTo(a.parents(".mt-radio-inline")[0]),a.parents(".mt-checkbox-inline").size()>0&&e.appendTo(a.parents(".mt-checkbox-inline")[0])):a.parent(".input-group").size()>0?e.insertAfter(a.parent(".input-group")):a.attr("data-error-container")?e.appendTo(a.attr("data-error-container")):a.hasClass("hotel-category")?e.insertAfter(a.next()):a.hasClass("hotel-type")?e.insertAfter(a.next()):a.hasClass("market-rate-price-type")?(e.appendTo(".market-rate-container-error"),$(".market-rate-container-error > span").css("color","#e73d4a")):e.insertAfter(a)},invalidHandler:function(e,a){toastr.error("Please check the entry fields.","Error")},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error")},submitHandler:function(a){var i=$(a).find("button[type=submit]:focus").attr("data"),n=new FormData(o[0]),r=[];$('#modal-edit [name="check-measures[]"]').each(function(){$(this).prop("checked")&&r.push($(this).attr("data"))});var l=[];$('#modal-edit [name^="rate_type_"]:checked').each(function(){var e=$(this).attr("data-target"),a=$(this).attr("data-market"),t=$("#"+e).val(),d=$('#modal-edit :input[name="round_method_'+a+'_edit"]:checked').val(),i=$('#modal-edit :input[name="update_prices_'+a+'_edit"]:checked').val(),n={market_id:a,rate_type:$(this).val(),value:t,round_type:d,update_price:null==i?"0":i};l.push(n)}),n.append("paxTypes",JSON.stringify(t(_))),n.append("boardTypes",JSON.stringify(t(h))),n.append("roomTypes",JSON.stringify($("#modal-edit .js-data-ajax").val())),n.append("measures",JSON.stringify(r)),n.append("markets",JSON.stringify(l)),$.ajax({url:routeUpdate,type:"POST",data:n,contentType:!1,processData:!1,beforeSend:function(){App.showMask(!0,o)},complete:function(t,n){if(App.showMask(!1,o),"200"!=t.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var r=$.parseJSON(t.responseText);"success"==r.status?(toastr.success(r.message,"Success"),e=!0,"accept"==i&&$(a).find("button.cancel-form").click()):toastr.error(r.message,"Error"),d(h),d(_)}}})}}),$("#rate_fee_value_1_info").TouchSpin({min:-1e9,max:1e9,stepinterval:50,decimals:2,maxboostedstep:1e7,prefix:"$"}),$("#rate_percent_value_1_info").TouchSpin({min:0,max:100,step:1,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#table tbody").on("click",".dt-view",function(e){var a=i.row($(this).parents("tr")).data(),t=a.contract,d=t.hotel,n=t.pax_types,o=t.board_types,r=t.room_types,l=t.measures,s=t.markets,c=null!=d.country?d.country.name:"",_=null!=d.state?d.state.name:"",h=null!=d.city?d.city.name:"",v=null!=d.hotel_chain?d.hotel_chain.name:"";$("#modal-info :input[name=name]").val(t.name),$("#modal-info :input[name=valid-from]").val(moment(t.valid_from,"YYYY-MM-DD").format("DD.MM.YYYY")),$("#modal-info :input[name=valid-to]").val(moment(t.valid_to,"YYYY-MM-DD").format("DD.MM.YYYY")),$("#modal-info :input[name=hotel]").val(d.name),$("#modal-info :input[name=country-text]").val(c),$("#modal-info :input[name=state-text]").val(_),$("#modal-info :input[name=city-text]").val(h),$("#modal-info :input[name=postal-code]").val(d.postal_code),$("#modal-info :input[name=address]").val(d.address),$("#modal-info :input[name=category]").barrating("set",d.category),$("#modal-info :input[name=hotel-chain]").val(v),$("#modal-info :input[name=admin-phone]").val(d.admin_phone),$("#modal-info :input[name=admin-fax]").val(d.admin_fax),$("#modal-info :input[name=web-site]").val(d.web_site),$("#modal-info :input[name=turistic-licence]").val(d.turistic_licence),$("#modal-info :input[name=email]").val(d.email),1==a.active?($("#modal-info :input[name=active]").prop("checked","checked"),$("#modal-info :input[name=active]").val(1)):($("#modal-info :input[name=active]").prop("checked",""),$("#modal-info :input[name=active]").val(0)),$('#modal-info [name="check-measures[]"]').prop("checked","");for(var f=0;f<l.length;f++)$('#modal-info [name="check-measures[]"][data="'+l[f].id+'"]').prop("checked","checked");$("#modal-info [data-tab]").each(function(){"1"!=$(this).attr("data-tab")&&$(this).remove()}),$("#modal-info .nav-tabs li").children("a").first().click(),$("#modal-info [id=rate_fee_value_1_info]").val(""),$("#modal-info [id=rate_fee_value_1_info]").attr("disabled","disabled"),$("#modal-info [id=rate_percent_value_1_info]").val(""),$("#modal-info [id=rate_percent_value_1_info]").attr("disabled","disabled");for(f=0;f<s.length;f++){var b=s[f].pivot;if(1==s[f].id)"1"==b.type?($("#modal-info [id=rate_percent_value_1_info]").val(b.value),$("#modal-info [id=rate_type_percent_1_info]").prop("checked","checked")):"2"==b.type&&($("#modal-info [id=rate_fee_value_1_info]").val(b.value),$("#modal-info [id=rate_type_fee_1_info]").prop("checked","checked")),"1"==b.round?$("#modal-info [id=round_method_1_1_info]").prop("checked","checked"):"2"==b.round?$("#modal-info [id=round_method_2_1_info]").prop("checked","checked"):"3"==b.round&&$("#modal-info [id=round_method_3_1_info]").prop("checked","checked");else{var y='<li data-tab="'+s[f].id+'">',g='<div class="tab-pane" id="tab_'+s[f].id+'_info" data-tab="'+s[f].id+'">';y+='<a href="#tab_'+s[f].id+'_info" data-toggle="tab"> '+s[f].name+" </a></li>",g+='<div class="row" style="margin-top:15px;"><div class="col-md-6 col-sm-6 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio">',"1"==b.type?g+='<input type="radio" name="rate_type_'+s[f].id+'" id="rate_type_percent_'+s[f].id+'_info" value="1" data-target="rate_percent_value_'+s[f].id+'_info" data-market="'+s[f].id+'" checked onclick="return false;"><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="'+b.value+'" name="rate_percent_value_'+s[f].id+'" id="rate_percent_value_'+s[f].id+'_info" disabled/></div>':g+='<input type="radio" name="rate_type_'+s[f].id+'" id="rate_type_percent_'+s[f].id+'_info" value="1" data-target="rate_percent_value_'+s[f].id+'_info" data-market="'+s[f].id+'" onclick="return false;"><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="" name="rate_percent_value_'+s[f].id+'" id="rate_percent_value_'+s[f].id+'_info" disabled/></div>',g+='<span style="margin-top: 8px;"></span></label><label class="mt-radio mt-radio-outline custom-radio">',"2"==b.type?g+='<input type="radio" name="rate_type_'+s[f].id+'" id="rate_type_fee_'+s[f].id+'_info" value="2" data-target="rate_fee_value_'+s[f].id+'_info" data-market="'+s[f].id+'" checked onclick="return false;"><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="'+b.value+'" name="rate_fee_value_'+s[f].id+'" id="rate_fee_value_'+s[f].id+'_info" disabled/></div>':g+='<input type="radio" name="rate_type_'+s[f].id+'" id="rate_type_fee_'+s[f].id+'_info" value="2" data-target="rate_fee_value_'+s[f].id+'_info" data-market="'+s[f].id+'" onclick="return false;"><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="" name="rate_fee_value_'+s[f].id+'" id="rate_fee_value_'+s[f].id+'_info" disabled/></div>',g+='<span style="margin-top: 8px;"></span></label></div></div><div class="col-md-6 col-sm-6 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio">',"1"==b.round?g+='<input type="radio" name="round_method_'+s[f].id+'" id="round_method_1_'+s[f].id+'_info" value="1" data-market="'+s[f].id+'" checked onclick="return false;"> Default Round':g+='<input type="radio" name="round_method_'+s[f].id+'" id="round_method_1_'+s[f].id+'_info" value="1" data-market="'+s[f].id+'" onclick="return false;"> Default Round',g+='<span></span></label><label class="mt-radio mt-radio-outline custom-radio">',"2"==b.round?g+='<input type="radio" name="round_method_'+s[f].id+'" id="round_method_2_'+s[f].id+'_info" value="2" data-market="'+s[f].id+'" checked onclick="return false;"> Integer Round':g+='<input type="radio" name="round_method_'+s[f].id+'" id="round_method_2_'+s[f].id+'_info" value="2" data-market="'+s[f].id+'" onclick="return false;"> Integer Round',g+='<span></span></label><label class="mt-radio mt-radio-outline custom-radio">',"3"==b.round?g+='<input type="radio" name="round_method_'+s[f].id+'" id="round_method_3_'+s[f].id+'_info" value="3" data-market="'+s[f].id+'" checked onclick="return false;"> Integer Round Up':g+='<input type="radio" name="round_method_'+s[f].id+'" id="round_method_3_'+s[f].id+'_info" value="3" data-market="'+s[f].id+'" onclick="return false;"> Integer Round Up',g+="<span></span></label></div></div></div>",g+="</div>",$("#modal-info .market-rate-container .custom-tab").append(y),$("#modal-info .market-rate-container .custom-content").append(g),$("#rate_fee_value_"+s[f].id+"_info").TouchSpin({min:-1e9,max:1e9,stepinterval:50,decimals:2,maxboostedstep:1e7,prefix:"$"}),$("#rate_percent_value_"+s[f].id+"_info").TouchSpin({min:0,max:100,step:1,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"})}}m.api().clear();for(f=0;f<n.length;f++)m.api().row.add([n[f].id,n[f].code+": "+n[f].name,n[f].agefrom,n[f].ageto]).draw(!1);m.api().columns.adjust().draw(),p.api().clear();for(f=0;f<o.length;f++)p.api().row.add([o[f].id,o[f].code+": "+o[f].name]).draw(!1);p.api().columns.adjust().draw(),u.api().clear();for(f=0;f<r.length;f++)u.api().row.add([r[f].id,r[f].code+": "+r[f].name,r[f].maxpax,r[f].minpax,r[f].minadult,r[f].minchildren,r[f].minchildren]).draw(!1);u.api().columns.adjust().draw(),e.preventDefault()}),$("#modal-edit :input[name=hotel]").select2({width:"off",ajax:{url:routeHotelSearchActive,type:"POST",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,a){return{results:e}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:3,templateResult:g,templateSelection:k}),$("#modal-edit :input[name=hotel]").on("select2:select select2:unselect",function(e){var a=e.params.data;if(a.selected){var t=null!=a.country?a.country.name:"",d=null!=a.state?a.state.name:"",i=null!=a.city?a.city.name:"",n=null!=a.hotel_chain?a.hotel_chain.name:"";$("#modal-edit .show-hotel :input[name=hotel-id]").val(a.id),$("#modal-edit .show-hotel :input[name=name]").val(a.name),$("#modal-edit .show-hotel :input[name=country-text]").val(t),$("#modal-edit .show-hotel :input[name=state-text]").val(d),$("#modal-edit .show-hotel :input[name=city-text]").val(i),$("#modal-edit .show-hotel :input[name=postal-code]").val(a.postal_code),$("#modal-edit .show-hotel :input[name=address]").val(a.address),$("#modal-edit .show-hotel :input[name=category]").barrating("readonly",!0);var o=null!=a.category?a.category:"";$("#modal-edit .show-hotel :input[name=category]").barrating("set",o),$("#modal-edit .show-hotel :input[name=hotel-chain]").val(n),$("#modal-edit .show-hotel :input[name=admin-phone]").val(a.admin_phone),$("#modal-edit .show-hotel :input[name=admin-fax]").val(a.admin_fax),$("#modal-edit .show-hotel :input[name=web-site]").val(a.web_site),$("#modal-edit .show-hotel :input[name=turistic-licence]").val(a.turistic_licence),$("#modal-edit .show-hotel :input[name=email]").val(a.email)}}),$("#rate_fee_value_1_edit").TouchSpin({min:-1e9,max:1e9,stepinterval:50,decimals:2,maxboostedstep:1e7,prefix:"$"}),$("#rate_percent_value_1_edit").TouchSpin({min:0,max:100,step:1,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#modal-edit :input[name=select-markets]").multiSelect({afterSelect:function(e){var a='<li data-tab="'+e+'">',t='<div class="tab-pane" id="tab_'+e+'_edit" data-tab="'+e+'">';a+='<a href="#tab_'+e+'_edit" data-toggle="tab"> '+$("#modal-edit :input[name=select-markets] option[value="+e+"]").html()+" </a></li>",t+='<div class="row" style="margin-top:15px;"><div class="col-md-5 col-sm-5 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="rate_type_'+e+'" id="rate_type_percent_'+e+'_edit" value="1" data-target="rate_percent_value_'+e+'_edit" data-market="'+e+'" checked><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="" name="rate_percent_value_'+e+'" id="rate_percent_value_'+e+'_edit"/></div><span style="margin-top: 8px;"></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="rate_type_'+e+'" id="rate_type_fee_'+e+'_edit" value="2" data-target="rate_fee_value_'+e+'_edit" data-market="'+e+'"><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="" name="rate_fee_value_'+e+'" id="rate_fee_value_'+e+'_edit" disabled/></div><span style="margin-top: 8px;"></span></label></div></div><div class="col-md-3 col-sm-3 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_edit" id="round_method_1_'+e+'" value="1" data-market="'+e+'" checked> Default Round<span></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_edit" id="round_method_2_'+e+'" value="2" data-market="'+e+'"> Integer Round<span></span></label><label class="mt-radio mt-radio-outline custom-radio"><input type="radio" name="round_method_'+e+'_edit" id="round_method_3_'+e+'" value="3" data-market="'+e+'"> Integer Round Up<span></span></label></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class="mt-checkbox-list" style="padding: 0"><label class="mt-checkbox mt-checkbox-outline"><input type="checkbox" name="update_prices_'+e+'_edit" value="1"> Update related prices<span></span></label></div></div></div>',t+="</div>",$("#modal-edit .market-rate-container .custom-tab").append(a),$("#modal-edit .market-rate-container .custom-content").append(t),$("#modal-edit .market-rate-container").show(),$("#rate_fee_value_"+e+"_edit").TouchSpin({min:-1e9,max:1e9,stepinterval:50,decimals:2,maxboostedstep:1e7,prefix:"$"}),$("#rate_percent_value_"+e+"_edit").TouchSpin({min:0,max:100,step:1,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#rate_type_percent_"+e+"_edit").change(function(){$("#rate_fee_value_"+e+"_edit").val(""),$("#rate_fee_value_"+e+"_edit").attr("disabled","disabled"),$("#rate_percent_value_"+e+"_edit").removeAttr("disabled")}),$("#rate_type_fee_"+e+"_edit").change(function(){$("#rate_percent_value_"+e+"_edit").val(""),$("#rate_percent_value_"+e+"_edit").attr("disabled","disabled"),$("#rate_fee_value_"+e+"_edit").removeAttr("disabled")})},afterDeselect:function(e){$('#modal-edit [data-tab="'+e+'"]').remove(),$("#modal-edit .nav-tabs li").children("a").first().click()},keepOrder:!0}),$("#table tbody").on("click",".dt-edit",function(e){$("#modal-edit .parent-select-room").html(""),d(h),d(_),o.validate().resetForm(),o[0].reset();var t=i.row($(this).parents("tr")).data(),n=t.contract,r=n.hotel,l=n.pax_types,s=n.board_types,c=n.room_types,m=n.measures,p=n.markets,u=null!=r.country?r.country.name:"",v=null!=r.state?r.state.name:"",g=null!=r.city?r.city.name:"",k=null!=r.hotel_chain?r.hotel_chain.name:"";$("#modal-edit :input[name=id]").val(n.id),$("#modal-edit :input[name=hotel-id]").val(r.id),$("#modal-edit .select2-selection__rendered").html(r.name+'<span class="select2-selection__placeholder"></span>'),$("#modal-edit :input[name=name]").val(n.name),$("#modal-edit :input[name=valid-from]").datepicker("setDate",new Date(moment(n.valid_from,"YYYY-MM-DD"))),$("#modal-edit :input[name=valid-to]").datepicker("setDate",new Date(moment(n.valid_to,"YYYY-MM-DD"))),$("#modal-edit :input[name=country-text]").val(u),$("#modal-edit :input[name=state-text]").val(v),$("#modal-edit :input[name=city-text]").val(g),$("#modal-edit :input[name=postal-code]").val(r.postal_code),$("#modal-edit :input[name=address]").val(r.address),$("#modal-edit :input[name=category]").barrating("set",r.category),$("#modal-edit :input[name=hotel-chain]").val(k),$("#modal-edit :input[name=admin-phone]").val(r.admin_phone),$("#modal-edit :input[name=admin-fax]").val(r.admin_fax),$("#modal-edit :input[name=web-site]").val(r.web_site),$("#modal-edit :input[name=turistic-licence]").val(r.turistic_licence),$("#modal-edit :input[name=email]").val(r.email),1==t.active?($("#modal-edit :input[name=active]").prop("checked","checked"),$("#modal-edit :input[name=active]").val(1)):($("#modal-edit :input[name=active]").prop("checked",""),$("#modal-edit :input[name=active]").val(0));for(var x=0;x<m.length;x++)$('#modal-edit [name="check-measures[]"][data="'+m[x].id+'"]').prop("checked","checked");$("#modal-edit :input[name=select-markets]").multiSelect("deselect_all"),$("#modal-edit .ms-elem-selectable").removeClass("ms-hover"),$("#modal-edit [id=rate_fee_value_1_edit]").val(""),$("#modal-edit [id=rate_percent_value_1_edit]").val(""),$("#modal-edit [data-tab]").each(function(){"1"!=$(this).attr("data-tab")&&$(this).remove()}),$("#modal-edit .nav-tabs li").children("a").first().click(),$("#modal-edit [id=rate_type_percent_1_edit]").change(function(){$("#modal-edit [id=rate_fee_value_1_edit]").val(""),$("#modal-edit [id=rate_fee_value_1_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_percent_value_1_edit]").removeAttr("disabled")}),$("#modal-edit [id=rate_type_fee_1_edit]").change(function(){$("#modal-edit [id=rate_percent_value_1_edit]").val(""),$("#modal-edit [id=rate_percent_value_1_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_fee_value_1_edit]").removeAttr("disabled")});for(x=0;x<p.length;x++){var w=p[x].pivot;if(1==p[x].id)"1"==w.type?($("#modal-edit [id=rate_percent_value_1_edit]").val(w.value),$("#modal-edit [id=rate_type_percent_1_edit]").prop("checked","checked"),$("#modal-edit [id=rate_fee_value_1_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_percent_value_1_edit]").removeAttr("disabled")):"2"==w.type&&($("#modal-edit [id=rate_fee_value_1_edit]").val(w.value),$("#modal-edit [id=rate_type_fee_1_edit]").prop("checked","checked"),$("#modal-edit [id=rate_percent_value_1_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_fee_value_1_edit]").removeAttr("disabled")),"1"==w.round?$("#modal-edit [id=round_method_1_1_edit]").prop("checked","checked"):"2"==w.round?$("#modal-edit [id=round_method_2_1_edit]").prop("checked","checked"):"3"==w.round&&$("#modal-edit [id=round_method_3_1_edit]").prop("checked","checked");else{$("#modal-edit :input[name=select-markets]").find("option[value="+p[x].id+"]").prop("selected","selected");var T='<li data-tab="'+p[x].id+'">',D='<div class="tab-pane" id="tab_'+p[x].id+'_edit" data-tab="'+p[x].id+'">';T+='<a href="#tab_'+p[x].id+'_edit" data-toggle="tab"> '+p[x].name+" </a></li>",D+='<div class="row" style="margin-top:15px;"><div class="col-md-5 col-sm-5 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio">',"1"==w.type?D+='<input type="radio" name="rate_type_'+p[x].id+'" id="rate_type_percent_'+p[x].id+'_edit" value="1" data-target="rate_percent_value_'+p[x].id+'_edit" data-market="'+p[x].id+'" checked><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="'+w.value+'" name="rate_percent_value_'+p[x].id+'" id="rate_percent_value_'+p[x].id+'_edit"/></div>':D+='<input type="radio" name="rate_type_'+p[x].id+'" id="rate_type_percent_'+p[x].id+'_edit" value="1" data-target="rate_percent_value_'+p[x].id+'_edit" data-market="'+p[x].id+'"><div class="form-group"><input class="form-control percent" placeholder="Percent" type="text" value="" name="rate_percent_value_'+p[x].id+'" id="rate_percent_value_'+p[x].id+'_edit" disabled/></div>',D+='<span style="margin-top: 8px;"></span></label><label class="mt-radio mt-radio-outline custom-radio">',"2"==w.type?D+='<input type="radio" name="rate_type_'+p[x].id+'" id="rate_type_fee_'+p[x].id+'_edit" value="2" data-target="rate_fee_value_'+p[x].id+'_edit" data-market="'+p[x].id+'" checked><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="'+w.value+'" name="rate_fee_value_'+p[x].id+'" id="rate_fee_value_'+p[x].id+'_edit"/></div>':D+='<input type="radio" name="rate_type_'+p[x].id+'" id="rate_type_fee_'+p[x].id+'_edit" value="2" data-target="rate_fee_value_'+p[x].id+'_edit" data-market="'+p[x].id+'"><div class="form-group"><input class="form-control fee" placeholder="Fee" type="text" value="" name="rate_fee_value_'+p[x].id+'" id="rate_fee_value_'+p[x].id+'_edit" disabled/></div>',D+='<span style="margin-top: 8px;"></span></label></div></div><div class="col-md-3 col-sm-3 col-xs-12"><div class="mt-radio-list" style="padding: 0;"><label class="mt-radio mt-radio-outline custom-radio">',"1"==w.round?D+='<input type="radio" name="round_method_'+p[x].id+'_edit" id="round_method_1_'+p[x].id+'_edit" value="1" data-market="'+p[x].id+'" checked> Default Round':D+='<input type="radio" name="round_method_'+p[x].id+'_edit" id="round_method_1_'+p[x].id+'_edit" value="1" data-market="'+p[x].id+'"> Default Round',D+='<span></span></label><label class="mt-radio mt-radio-outline custom-radio">',"2"==w.round?D+='<input type="radio" name="round_method_'+p[x].id+'_edit" id="round_method_2_'+p[x].id+'_edit" value="2" data-market="'+p[x].id+'" checked> Integer Round':D+='<input type="radio" name="round_method_'+p[x].id+'_edit" id="round_method_2_'+p[x].id+'_edit" value="2" data-market="'+p[x].id+'"> Integer Round',D+='<span></span></label><label class="mt-radio mt-radio-outline custom-radio">',"3"==w.round?D+='<input type="radio" name="round_method_'+p[x].id+'_edit" id="round_method_3_'+p[x].id+'_edit" value="3" data-market="'+p[x].id+'" checked> Integer Round Up':D+='<input type="radio" name="round_method_'+p[x].id+'_edit" id="round_method_3_'+p[x].id+'_edit" value="3" data-market="'+p[x].id+'"> Integer Round Up',D+='<span></span></label></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class="mt-checkbox-list" style="padding: 0"><label class="mt-checkbox mt-checkbox-outline"><input type="checkbox" name="update_prices_'+p[x].id+'_edit" value="1"> Update related prices<span></span></label></div></div></div>',D+="</div>",$("#modal-edit .market-rate-container .custom-tab").append(T),$("#modal-edit .market-rate-container .custom-content").append(D),$("#rate_fee_value_"+p[x].id+"_edit").TouchSpin({min:-1e9,max:1e9,stepinterval:50,decimals:2,maxboostedstep:1e7,prefix:"$"}),$("#rate_percent_value_"+p[x].id+"_edit").TouchSpin({min:0,max:100,step:1,decimals:2,boostat:5,maxboostedstep:10,postfix:"%"}),$("#modal-edit [id=rate_type_percent_"+p[x].id+"_edit]").change(function(){var e=$(this).attr("data-market");$("#modal-edit [id=rate_fee_value_"+e+"_edit]").val(""),$("#modal-edit [id=rate_fee_value_"+e+"_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_percent_value_"+e+"_edit]").removeAttr("disabled")}),$("#modal-edit [id=rate_type_fee_"+p[x].id+"_edit]").change(function(){var e=$(this).attr("data-market");$("#modal-edit [id=rate_percent_value_"+e+"_edit]").val(""),$("#modal-edit [id=rate_percent_value_"+e+"_edit]").attr("disabled","disabled"),$("#modal-edit [id=rate_fee_value_"+e+"_edit]").removeAttr("disabled")})}}$("#modal-edit :input[name=select-markets]").multiSelect("refresh");for(x=0;x<l.length;x++)$('tbody > tr > td:nth-child(1) input[type="checkbox"]',_).each(function(){_.api().row($(this).parents("tr")).data()[1]==l[x].id&&$(this).prop("checked","checked")});$("#modal-edit :input[name=count-pax-type]").val(a(_)),_.api().columns.adjust().draw();for(x=0;x<s.length;x++)$('tbody > tr > td:nth-child(1) input[type="checkbox"]',h).each(function(){h.api().row($(this).parents("tr")).data()[1]==s[x].id&&$(this).prop("checked","checked")});$("#modal-edit :input[name=count-board-type]").val(a(h)),h.api().columns.adjust().draw();var S=[],j=[];f.api().clear();for(x=0;x<c.length;x++)f.api().row.add([c[x].id,c[x].code+": "+c[x].name,c[x].maxpax,c[x].minpax,c[x].minadult,c[x].minchildren,c[x].minchildren]).draw(!1),j.push({id:c[x].id,code:c[x].code,name:c[x].name}),S.push(c[x].id);$("#modal-edit :input[name=count-room-type]").val(c.length),f.api().columns.adjust().draw();$("#modal-edit .parent-select-room").append('<label class="control-label">Search Room Type</label><div class="input-group input-group-md select2-bootstrap-append"><select class="form-control js-data-ajax" multiple></select></div>'),$("#modal-edit .js-data-ajax").select2({data:j,width:"off",ajax:{url:routeRoomTypeSearchActive,type:"POST",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,a){return{results:e}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:3,templateResult:b,templateSelection:y}),$("#modal-edit .js-data-ajax").on("select2:select select2:unselect",function(e){var a=e.params.data;if(a.selected)f.api().row.add([a.id,a.code+": "+a.name,a.maxpax,a.minpax,a.minadult,a.minchildren,a.minchildren]).draw(!1),f.api().columns.adjust().draw();else{var t=!1,d=$(this).val();if(null!=d)for(var i=0;i<d.length;i++)if(d[i]==a.id){t=!0;break}t||f.api().rows(function(e,t,d){return t[0]==a.id}).remove().draw()}$("#modal-edit :input[name=count-room-type]").val(f.api().rows().count())}),$("#modal-edit .js-data-ajax").val(S).trigger("change"),e.preventDefault()}),$("#table tbody").on("click",".dt-delete",function(e){var a=i.row($(this).parents("tr")).data();$(this).confirmation("show"),$(this).on("confirmed.bs.confirmation",function(){$.ajax({url:routeDelete,type:"POST",data:{id:a.id},beforeSend:function(){App.showMask(!0,n)},complete:function(e,a){if(App.showMask(!1,n),"200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"success"==t.status?(toastr.success(t.message,"Success"),i.draw()):toastr.error(t.message,"Error")}}})}),e.preventDefault()}),$(".cancel-form").on("click",function(a){e&&(i.draw(),e=!1)}),$(".btn-search-reset").on("click",function(e){e.preventDefault(),$("#search-section :input[name=name]").val(""),$("#search-section :input[name=hotel]").val(""),$("#search-section :input[name=active]").val(""),$("#search-section :input[name=valid-from]").val(""),$("#search-section :input[name=valid-to]").val("")}),$(".btn-search-cancel").on("click",function(e){e.preventDefault(),$("#search-section").slideToggle()}),$(".btn-search-submit").on("click",function(e){e.preventDefault(),i.columns("name:name").search($("#search-section :input[name=name]").val()).columns("hotel:name").search($("#search-section :input[name=hotel]").val()).columns("valid_from:name").search($("#search-section :input[name=valid-from]").val()).columns("valid_to:name").search($("#search-section :input[name=valid-to]").val()).columns("active:name").search($("#search-section :input[name=active]").val()).draw()});var r=$("#modal-add .table-pax-type").dataTable({sDom:"t",autoWidth:!1,columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[3,"asc"]],lengthMenu:[[-1],["All"]]});r.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),t=jQuery(this).is(":checked");jQuery(e).each(function(){t?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))}),$("#modal-add :input[name=count-pax-type]").val(a(r))}),r.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active"),$("#modal-add :input[name=count-pax-type]").val(a(r))});var l=$("#modal-add .table-board-type").dataTable({sDom:"t",columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[2,"asc"]],autoWidth:!1,lengthMenu:[[-1],["All"]]});l.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),t=jQuery(this).is(":checked");jQuery(e).each(function(){t?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))}),$("#modal-add :input[name=count-board-type]").val(a(l))}),l.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active"),$("#modal-add :input[name=count-board-type]").val(a(l))});var s=$("#modal-add .table-market").dataTable({sDom:"t",columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[2,"asc"]],autoWidth:!1,lengthMenu:[[-1],["All"]]});s.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),a=jQuery(this).is(":checked");jQuery(e).each(function(){a?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))})}),s.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active")});var c=$("#modal-add .table-room-type").dataTable({sDom:"t",lengthMenu:[[-1],["All"]],ordering:!1,autoWidth:!1,columnDefs:[{visible:!1,targets:[0]},{targets:[1],width:"35%"}],language:{emptyTable:"No room type selected"}}),m=$("#modal-info .table-pax-type").dataTable({sDom:"t",columnDefs:[{visible:!1,targets:[0]}],order:[[2,"asc"]],lengthMenu:[[-1],["All"]]}),p=$("#modal-info .table-board-type").dataTable({sDom:"t",columnDefs:[{visible:!1,targets:[0]}],order:[[1,"asc"]],lengthMenu:[[-1],["All"]]}),u=$("#modal-info .table-room-type").dataTable({sDom:"t",lengthMenu:[[-1],["All"]],order:[[1,"asc"]],autoWidth:!1,columnDefs:[{visible:!1,targets:[0]},{targets:[1],width:"35%"},{orderable:!1,targets:[2]},{orderable:!1,targets:[3]},{orderable:!1,targets:[4]},{orderable:!1,targets:[5]},{orderable:!1,targets:[6]}],language:{emptyTable:"No room type selected"}}),_=$("#modal-edit .table-pax-type").dataTable({sDom:"t",autoWidth:!1,columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[3,"asc"]],lengthMenu:[[-1],["All"]]});_.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),t=jQuery(this).is(":checked");jQuery(e).each(function(){t?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))}),$("#modal-edit :input[name=count-pax-type]").val(a(_))}),_.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active"),$("#modal-edit :input[name=count-pax-type]").val(a(_))});var h=$("#modal-edit .table-board-type").dataTable({sDom:"t",autoWidth:!1,columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[2,"asc"]],lengthMenu:[[-1],["All"]]});h.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),t=jQuery(this).is(":checked");jQuery(e).each(function(){t?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))}),$("#modal-edit :input[name=count-board-type]").val(a(h))}),h.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active"),$("#modal-edit :input[name=count-board-type]").val(a(h))});var v=$("#modal-edit .table-measure").dataTable({sDom:"t",autoWidth:!1,columnDefs:[{orderable:!1,className:"dt-center",targets:[0],width:"20%"},{visible:!1,targets:[1]}],order:[[2,"asc"]],lengthMenu:[[-1],["All"]]});v.find(".group-checkable").change(function(){var e=jQuery(this).attr("data-set"),t=jQuery(this).is(":checked");jQuery(e).each(function(){t?($(this).prop("checked",!0),$(this).parents("tr").addClass("active")):($(this).prop("checked",!1),$(this).parents("tr").removeClass("active"))}),$("#modal-edit :input[name=count-measure]").val(a(v))}),v.on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active"),$("#modal-edit :input[name=count-measure]").val(a(v))});var f=$("#modal-edit .table-room-type").dataTable({sDom:"t",lengthMenu:[[-1],["All"]],ordering:!1,autoWidth:!1,columnDefs:[{visible:!1,targets:[0]},{width:"35%",targets:[1]}],language:{emptyTable:"No room type selected"}});function b(e){return e.loading?e.text:"<div class=''><div class=''>"+e.code+": "+e.name+"</div></div>"}function y(e){return e.code+": "+e.name}function g(e){return e.loading?e.text:"<div class=''><div class=''>"+e.name+"</div></div>"}function k(e){return e.name}$("#modal-add :input[name=hotel]").select2({width:"off",ajax:{url:routeHotelSearchActive,type:"POST",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,a){return{results:e}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:3,templateResult:g,templateSelection:k}),$("#modal-add :input[name=hotel]").on("select2:select select2:unselect",function(e){var a=e.params.data;if(a.selected){var t=null!=a.country?a.country.name:"",d=null!=a.state?a.state.name:"",i=null!=a.city?a.city.name:"",n=null!=a.hotel_chain?a.hotel_chain.name:"";$("#modal-add .show-hotel :input[name=hotel-id]").val(a.id),$("#modal-add .show-hotel :input[name=name]").val(a.name),$("#modal-add .show-hotel :input[name=country-text]").val(t),$("#modal-add .show-hotel :input[name=state-text]").val(d),$("#modal-add .show-hotel :input[name=city-text]").val(i),$("#modal-add .show-hotel :input[name=postal-code]").val(a.postal_code),$("#modal-add .show-hotel :input[name=address]").val(a.address),$("#modal-add .show-hotel :input[name=category]").barrating("readonly",!0);var o=null!=a.category?a.category:"";$("#modal-add .show-hotel :input[name=category]").barrating("set",o),$("#modal-add .show-hotel :input[name=hotel-chain]").val(n),$("#modal-add .show-hotel :input[name=admin-phone]").val(a.admin_phone),$("#modal-add .show-hotel :input[name=admin-fax]").val(a.admin_fax),$("#modal-add .show-hotel :input[name=web-site]").val(a.web_site),$("#modal-add .show-hotel :input[name=turistic-licence]").val(a.turistic_licence),$("#modal-add .show-hotel :input[name=email]").val(a.email)}}),$("#modal-add .js-data-ajax").select2({width:"off",ajax:{url:routeRoomTypeSearchActive,type:"POST",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,a){return{results:e}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:3,templateResult:b,templateSelection:y}),$("#modal-add .js-data-ajax").on("select2:select select2:unselect",function(e){var a=e.params.data;if(a.selected)c.api().row.add([a.id,a.code+": "+a.name,a.maxpax,a.minpax,a.minadult,a.minchildren,a.minchildren]).draw(!1),c.api().columns.adjust().draw();else{var t=!1,d=$(this).val();if(null!=d)for(var i=0;i<d.length;i++)if(d[i]==a.id){t=!0;break}t||c.api().rows(function(e,t,d){return t[0]==a.id}).remove().draw()}$("#modal-add :input[name=count-room-type]").val(c.api().rows().count())}),$("button[data-select2-open]").click(function(){$("#"+$(this).data("select2-open")).select2("open")})});