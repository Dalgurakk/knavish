$(document).ready(function(){var r=!1,i=null;$.fn.dataTable.ext.errMode="none";var t=$("#table").on("error.dt",function(a,e,n,t){}).on("processing.dt",function(a,e,n){App.showMask(n,$(this)),App.reloadToolTips()}).on("init.dt",function(){}).DataTable({processing:!0,serverSide:!0,sDom:"ltip",iDisplayLength:25,ajax:{url:routeRead,type:"POST",complete:function(a,e){"200"!=a.status&&toastr.error("Please check your connection and try again.","Error on loading the content")}},order:[[1,"asc"]],columns:[{data:"id",name:"id",visible:!1},{data:"code",name:"code"},{data:"name",name:"name",width:"35%"},{data:"max_pax",name:"maxpax"},{data:"min_pax",name:"minpax"},{data:"max_adult",name:"maxadult"},{data:"min_adult",name:"minadult"},{data:"max_children",name:"maxchildren"},{data:"min_children",name:"minchildren"},{data:"max_infant",name:"maxinfant"},{data:"min_infant",name:"mininfant"},{data:"active",name:"active",className:"dt-center",data:function(a,e,n,t){var i='<span><i class="fa fa-close dt-active dt-active-0"></i></span>';return 1==a.active&&(i='<span><i class="fa fa-check dt-active dt-active-1"></i></span>'),i}},{targets:"actions",orderable:!1,name:"actions",className:"dt-center",data:function(a,e,n,t){return'<div class="dt-actions"><a class="btn btn-default btn-circle btn-icon-only btn-action dt-view" data-toggle="modal" href="#modal-info"><i class="glyphicon glyphicon-eye-open btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-edit" data-toggle="modal" href="#modal-edit"><i class="icon-pencil btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-delete" href="javascript:;" data-popout="true" data-placement="left"data-btn-ok-label="Yes" data-btn-ok-class="btn-sm btn-success"  data-btn-ok-icon-content="check" data-btn-cancel-label="No" data-btn-cancel-class="btn-sm btn-danger" data-btn-cancel-icon-content="close" data-title="Are you sure?" data-content=""><i class="icon-trash btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-duplicate" href="javascript:;" data-popout="true" data-placement="left"data-btn-ok-label="Yes" data-btn-ok-class="btn-sm btn-success btn-confirmation"  data-btn-ok-icon-content="check" data-btn-cancel-label="No" data-btn-cancel-class="btn-sm btn-danger btn-confirmation" data-btn-cancel-icon-content="close" data-title="Are you sure?" data-content=""><i class="icon-docs btn-action-icon"></i></a></div>'}}]});$("#table_length").hide(),$(".search").on("click",function(a){$("#search-section").slideToggle()}),$(".reload").on("click",function(a){t.draw()}),$(".add").on("click",function(){o.validate().resetForm(),o[0].reset()}),$(".lenght-option").on("click",function(){var a=$(this).attr("data");$(this).parent().parent().prev("a").text(a);var e=$("select[name=table_length]");e.val(a),e.change()}),$.validator.addMethod("notGreaterThan",function(a,e,n){return this.optional(e)||parseInt(a)<=parseInt($(n).val())},"Invalid value."),$.validator.addMethod("addTotalPaxValue",function(a,e){var n=($.isNumeric($("#modal-add :input[name=minadult]").val())?parseInt($("#modal-add :input[name=minadult]").val()):0)+($.isNumeric($("#modal-add :input[name=minchildren]").val())?parseInt($("#modal-add :input[name=minchildren]").val()):0)+($.isNumeric($("#modal-add :input[name=mininfant]").val())?parseInt($("#modal-add :input[name=mininfant]").val()):0);return this.optional(e)||parseInt(a)>=n},"The total of the min pax value can not exceed the max pax value.");var o=$("#form-add");o.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{required:!0},code:{required:!0},maxpax:{required:!0,digits:!0,min:"#modal-add :input[name=minpax]",addTotalPaxValue:!0},minpax:{required:!0,digits:!0,min:1,notGreaterThan:"#modal-add :input[name=maxpax]"},maxadult:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-add :input[name=maxpax]"},minadult:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-add :input[name=maxadult]"},maxchildren:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-add :input[name=maxpax]"},minchildren:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-add :input[name=maxchildren]"},maxinfant:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-add :input[name=maxpax]"},mininfant:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-add :input[name=maxinfant]"}},messages:{minpax:{notGreaterThan:"Must not be greater than Max Pax."},maxadult:{notGreaterThan:"Must not be greater than Max Pax."},maxchildren:{notGreaterThan:"Must not be greater than Max Pax."},maxinfant:{notGreaterThan:"Must not be greater than Max Pax."},minadult:{notGreaterThan:"Must not be greater than Max Adult."},minchildren:{notGreaterThan:"Must not be greater than Max Children."},mininfant:{notGreaterThan:"Must not be greater than Max Infant."}},errorPlacement:function(a,e){0<e.parents(".mt-radio-list").size()||0<e.parents(".mt-checkbox-list").size()?(0<e.parents(".mt-radio-list").size()&&a.appendTo(e.parents(".mt-radio-list")[0]),0<e.parents(".mt-checkbox-list").size()&&a.appendTo(e.parents(".mt-checkbox-list")[0])):0<e.parents(".mt-radio-inline").size()||0<e.parents(".mt-checkbox-inline").size()?(0<e.parents(".mt-radio-inline").size()&&a.appendTo(e.parents(".mt-radio-inline")[0]),0<e.parents(".mt-checkbox-inline").size()&&a.appendTo(e.parents(".mt-checkbox-inline")[0])):0<e.parent(".input-group").size()?a.insertAfter(e.parent(".input-group")):e.attr("data-error-container")?a.appendTo(e.attr("data-error-container")):a.insertAfter(e)},invalidHandler:function(a,e){toastr.error("Please check the entry fields.","Error")},highlight:function(a){$(a).closest(".form-group").addClass("has-error")},unhighlight:function(a){$(a).closest(".form-group").removeClass("has-error")},success:function(a){a.closest(".form-group").removeClass("has-error")},submitHandler:function(t){var i=$(t).find("button[type=submit]:focus").attr("data");$.ajax({url:routeCreate,type:"POST",data:o.serialize(),beforeSend:function(){App.showMask(!0,o)},complete:function(a,e){if(App.showMask(!1,o),"200"!=a.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var n=$.parseJSON(a.responseText);"success"==n.status?(toastr.success(n.message,"Success"),o[0].reset(),r=!0,"accept"==i&&$(t).find("button.cancel-form").click()):toastr.error(n.message,"Error")}}})}}),$(".mt-checkbox").change(function(){$(".mt-checkbox > input[type=checkbox]").is(":checked")?$(".mt-checkbox > input[type=checkbox]").val(1):$(".mt-checkbox > input[type=checkbox]").val(0)}),$.validator.addMethod("editTotalPaxValue",function(a,e){var n=($.isNumeric($("#modal-edit :input[name=minadult]").val())?parseInt($("#modal-edit :input[name=minadult]").val()):0)+($.isNumeric($("#modal-edit :input[name=minchildren]").val())?parseInt($("#modal-edit :input[name=minchildren]").val()):0)+($.isNumeric($("#modal-edit :input[name=mininfant]").val())?parseInt($("#modal-edit :input[name=mininfant]").val()):0);return this.optional(e)||parseInt(a)>=n},"The total of the min pax value can not exceed the max pax value.");var c,d,s=$("#form-edit");s.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{required:!0},code:{required:!0},maxpax:{required:!0,digits:!0,min:"#modal-edit :input[name=minpax]",editTotalPaxValue:!0},minpax:{required:!0,digits:!0,min:1,notGreaterThan:"#modal-edit :input[name=maxpax]"},maxadult:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-edit :input[name=maxpax]"},minadult:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-edit :input[name=maxadult]"},maxchildren:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-edit :input[name=maxpax]"},minchildren:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-edit :input[name=maxchildren]"},maxinfant:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-edit :input[name=maxpax]"},mininfant:{required:!0,digits:!0,min:0,notGreaterThan:"#modal-edit :input[name=maxinfant]"}},messages:{minpax:{notGreaterThan:"Must not be greater than Max Pax."},maxadult:{notGreaterThan:"Must not be greater than Max Pax."},maxchildren:{notGreaterThan:"Must not be greater than Max Pax."},maxinfant:{notGreaterThan:"Must not be greater than Max Pax."},minadult:{notGreaterThan:"Must not be greater than Max Adult."},minchildren:{notGreaterThan:"Must not be greater than Max Children."},mininfant:{notGreaterThan:"Must not be greater than Max Infant."}},errorPlacement:function(a,e){0<e.parents(".mt-radio-list").size()||0<e.parents(".mt-checkbox-list").size()?(0<e.parents(".mt-radio-list").size()&&a.appendTo(e.parents(".mt-radio-list")[0]),0<e.parents(".mt-checkbox-list").size()&&a.appendTo(e.parents(".mt-checkbox-list")[0])):0<e.parents(".mt-radio-inline").size()||0<e.parents(".mt-checkbox-inline").size()?(0<e.parents(".mt-radio-inline").size()&&a.appendTo(e.parents(".mt-radio-inline")[0]),0<e.parents(".mt-checkbox-inline").size()&&a.appendTo(e.parents(".mt-checkbox-inline")[0])):0<e.parent(".input-group").size()?a.insertAfter(e.parent(".input-group")):e.attr("data-error-container")?a.appendTo(e.attr("data-error-container")):a.insertAfter(e)},invalidHandler:function(a,e){toastr.error("Please check the entry fields.","Error")},highlight:function(a){$(a).closest(".form-group").addClass("has-error")},unhighlight:function(a){$(a).closest(".form-group").removeClass("has-error")},success:function(a){a.closest(".form-group").removeClass("has-error")},submitHandler:function(t){var a=!1,e=new FormData(s[0]),n="1"==e.get("active")?1:0;i.code==e.get("code")&&i.name==e.get("name")&&i.max_pax==e.get("maxpax")&&i.min_pax==e.get("minpax")&&i.max_adult==e.get("maxadult")&&i.min_adult==e.get("minadult")&&i.max_children==e.get("maxchildren")&&i.min_children==e.get("minchildren")&&i.max_infant==e.get("maxinfant")&&i.min_infant==e.get("mininfant")&&i.active==n||(a=!0),a?$.ajax({url:routeUpdate,type:"POST",data:e,contentType:!1,processData:!1,beforeSend:function(){App.showMask(!0,s)},complete:function(a,e){if(App.showMask(!1,s),"200"!=a.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var n=$.parseJSON(a.responseText);"success"==n.status?(toastr.success(n.message,"Success"),r=!0,$(t).find("button.cancel-form").click()):toastr.error(n.message,"Error")}}}):$(t).find("button.cancel-form").click()}}),$("#table tbody").on("click",".dt-view",function(a){var e=t.row($(this).parents("tr")).data();$("#modal-info :input[name=code]").val(e.code),$("#modal-info :input[name=name]").val(e.name),$("#modal-info :input[name=maxpax]").val(e.max_pax),$("#modal-info :input[name=minpax]").val(e.min_pax),$("#modal-info :input[name=maxadult]").val(e.max_adult),$("#modal-info :input[name=minadult]").val(e.min_adult),$("#modal-info :input[name=maxchildren]").val(e.max_children),$("#modal-info :input[name=minchildren]").val(e.min_children),$("#modal-info :input[name=maxinfant]").val(e.max_infant),$("#modal-info :input[name=mininfant]").val(e.min_infant),1==e.active?($("#modal-info :input[name=active]").prop("checked","checked"),$("#modal-info :input[name=active]").val(1)):($("#modal-info :input[name=active]").prop("checked",""),$("#modal-info :input[name=active]").val(0)),a.preventDefault()}),$("#table tbody").on("click",".dt-edit",function(a){s.validate().resetForm(),s[0].reset();var e=t.row($(this).parents("tr")).data();i=e.object,$("#modal-edit :input[name=id]").val(e.id),$("#modal-edit :input[name=code]").val(e.code),$("#modal-edit :input[name=name]").val(e.name),$("#modal-edit :input[name=maxpax]").val(e.max_pax),$("#modal-edit :input[name=minpax]").val(e.min_pax),$("#modal-edit :input[name=maxadult]").val(e.max_adult),$("#modal-edit :input[name=minadult]").val(e.min_adult),$("#modal-edit :input[name=maxchildren]").val(e.max_children),$("#modal-edit :input[name=minchildren]").val(e.min_children),$("#modal-edit :input[name=maxinfant]").val(e.max_infant),$("#modal-edit :input[name=mininfant]").val(e.min_infant),1==e.active?($("#modal-edit :input[name=active]").prop("checked","checked"),$("#modal-edit :input[name=active]").val(1)):($("#modal-edit :input[name=active]").prop("checked",""),$("#modal-edit :input[name=active]").val(0)),a.preventDefault()}),$("#table tbody").on("click",".dt-delete",function(a){if(!c){c=!0;var e=t.row($(this).parents("tr")).data();$(this).confirmation("show"),$(this).on("confirmed.bs.confirmation",function(){c=$.ajax({url:routeDelete,type:"POST",data:{id:e.id},beforeSend:function(){App.showMask(!0,o)},complete:function(a,e){if(c=null,App.showMask(!1,o),"200"!=a.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var n=$.parseJSON(a.responseText);"success"==n.status?(toastr.success(n.message,"Success"),t.draw()):toastr.error(n.message,"Error")}}})})}a.preventDefault()}),$("#table tbody").on("click",".dt-duplicate",function(a){if(!d){d=!0;var e=t.row($(this).parents("tr")).data();$(this).confirmation("show"),$(this).on("confirmed.bs.confirmation",function(){d=$.ajax({url:routeDuplicate,type:"POST",data:{id:e.id},beforeSend:function(){App.blockUI({target:$(".custom-container"),animate:!0})},complete:function(a,e){if(d=null,App.showMask(!1,o),"200"!=a.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var n=$.parseJSON(a.responseText);"success"==n.status?(toastr.success(n.message,"Success"),t.draw()):toastr.error(n.message,"Error")}}}),App.unblockUI($(".custom-container"))})}a.preventDefault()}),$(".cancel-form").on("click",function(a){r&&(t.draw(),r=!1)}),$(".btn-search-reset").on("click",function(a){a.preventDefault(),$("#search-section :input[name=code]").val(""),$("#search-section :input[name=name]").val(""),$("#search-section :input[name=active]").val("")}),$(".btn-search-cancel").on("click",function(a){a.preventDefault(),$("#search-section").slideToggle()}),$(".btn-search-submit").on("click",function(a){a.preventDefault(),t.columns("code:name").search($("#search-section :input[name=code]").val()).columns("name:name").search($("#search-section :input[name=name]").val()).columns("active:name").search($("#search-section :input[name=active]").val()).draw()}),$(".excel").on("click",function(){var a={code:$("#search-section :input[name=code]").val(),name:$("#search-section :input[name=name]").val(),active:$("#search-section :input[name=active]").val()},e=routeExcel+"?"+$.param(a);window.location=e})});