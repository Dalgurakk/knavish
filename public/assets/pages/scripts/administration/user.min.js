$(document).ready(function(){var i=!1;$.fn.dataTable.ext.errMode="none";var n=$("#table").on("error.dt",function(e,a,t,n){}).on("processing.dt",function(e,a,t){App.showMask(t,$(this)),App.reloadToolTips()}).on("init.dt",function(){}).DataTable({processing:!0,serverSide:!0,sDom:"ltip",iDisplayLength:25,ajax:{url:routeRead,type:"POST",complete:function(e,a){"200"!=e.status&&toastr.error("Please check your connection and try again.","Error on loading the content")}},order:[[1,"asc"]],columns:[{data:"id",name:"id",visible:!1},{data:"username",name:"username"},{data:"role",name:"role",orderable:!1},{data:"role_id",name:"role_id",visible:!1,orderable:!1},{data:"name",name:"name"},{targets:"email",name:"email",data:function(e,a,t,n){return'<a href="mailto:'+e.email+'">'+e.email+"</a>"}},{data:"active",name:"active",className:"dt-center",data:function(e,a,t,n){var r='<span><i class="fa fa-close dt-active dt-active-0"></i></span>';return 1==e.active&&(r='<span><i class="fa fa-check dt-active dt-active-1"></i></span>'),r}},{targets:"actions",orderable:!1,name:"actions",className:"dt-center",data:function(e,a,t,n){return'<div class="dt-actions"><a class="btn btn-default btn-circle btn-icon-only btn-action dt-view" data-toggle="modal" href="#modal-info"><i class="glyphicon glyphicon-eye-open btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-edit" data-toggle="modal" href="#modal-edit"><i class="icon-pencil btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-delete" href="javascript:;" data-popout="true" data-placement="left"data-btn-ok-label="Yes" data-btn-ok-class="btn-sm btn-success"  data-btn-ok-icon-content="check" data-btn-cancel-label="No" data-btn-cancel-class="btn-sm btn-danger" data-btn-cancel-icon-content="close" data-title="Are you sure?" data-content=""><i class="icon-trash btn-action-icon"></i></a></div>'}}]});$("#table_length").hide(),$(".search").on("click",function(e){$("#search-section").slideToggle()}),$(".reload").on("click",function(e){n.draw()}),$(".add").on("click",function(){o.validate().resetForm(),o[0].reset()}),$(".lenght-option").on("click",function(){var e=$(this).attr("data");$(this).parent().parent().prev("a").text(e);var a=$("select[name=table_length]");a.val(e),a.change()});var o=$("#form-add");o.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{minlength:2,required:!0},email:{required:!0,email:!0},password:{required:!0},username:{required:!0},confirm_password:{required:!0,equalTo:"#modal-add :input[name=password]"},"role-id":{required:!0}},errorPlacement:function(e,a){0<a.parents(".mt-radio-list").size()||0<a.parents(".mt-checkbox-list").size()?(0<a.parents(".mt-radio-list").size()&&e.appendTo(a.parents(".mt-radio-list")[0]),0<a.parents(".mt-checkbox-list").size()&&e.appendTo(a.parents(".mt-checkbox-list")[0])):0<a.parents(".mt-radio-inline").size()||0<a.parents(".mt-checkbox-inline").size()?(0<a.parents(".mt-radio-inline").size()&&e.appendTo(a.parents(".mt-radio-inline")[0]),0<a.parents(".mt-checkbox-inline").size()&&e.appendTo(a.parents(".mt-checkbox-inline")[0])):0<a.parent(".input-group").size()?e.insertAfter(a.parent(".input-group")):a.attr("data-error-container")?e.appendTo(a.attr("data-error-container")):e.insertAfter(a)},invalidHandler:function(e,a){toastr.error("Please check the entry fields.","Error")},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error")},submitHandler:function(n){var r=$(n).find("button[type=submit]:focus").attr("data");$.ajax({url:routeCreate,type:"POST",data:o.serialize(),beforeSend:function(){App.showMask(!0,o)},complete:function(e,a){if(App.showMask(!1,o),"200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"success"==t.status?(toastr.success(t.message,"Success"),o[0].reset(),i=!0,"accept"==r&&$(n).find("button.cancel-form").click()):toastr.error(t.message,"Error")}}})}}),$(".btn-search-reset").on("click",function(e){e.preventDefault(),$("#search-section :input[name=username]").val(""),$("#search-section :input[name=role]").val(""),$("#search-section :input[name=name]").val(""),$("#search-section :input[name=email]").val(""),$("#search-section :input[name=active]").val("")}),$(".btn-search-cancel").on("click",function(e){e.preventDefault(),$("#search-section").slideToggle()}),$(".btn-search-submit").on("click",function(e){e.preventDefault();var a=""!=$("#search-section :input[name=role]").val()?$("#search-section :input[name=role] option:selected").text():"";n.columns("username:name").search($("#search-section :input[name=username]").val()).columns("role:name").search(a).columns("name:name").search($("#search-section :input[name=name]").val()).columns("email:name").search($("#search-section :input[name=email]").val()).columns("active:name").search($("#search-section :input[name=active]").val()).draw()}),$(".mt-checkbox").change(function(){$(".mt-checkbox > input[type=checkbox]").is(":checked")?$(".mt-checkbox > input[type=checkbox]").val(1):$(".mt-checkbox > input[type=checkbox]").val(0)}),$("#table tbody").on("click",".dt-view",function(e){var a=n.row($(this).parents("tr")).data();$("#modal-info :input[name=name]").val(a.name),$("#modal-info :input[name=email]").val(a.email),$("#modal-info :input[name=username]").val(a.username),$("#modal-info :input[name=role-id]").val(a.role),1==a.active?($("#modal-info :input[name=active]").prop("checked","checked"),$("#modal-info :input[name=active]").val(1)):($("#modal-info :input[name=active]").prop("checked",""),$("#modal-info :input[name=active]").val(0)),e.preventDefault()}),$("#table tbody").on("click",".dt-edit",function(e){s.validate().resetForm(),s[0].reset();var a=n.row($(this).parents("tr")).data();$("#modal-edit :input[name=id]").val(a.id),$("#modal-edit :input[name=name]").val(a.name),$("#modal-edit :input[name=email]").val(a.email),$("#modal-edit :input[name=username]").val(a.username),$("#modal-edit :input[name=role-id]").val(a.role_id).trigger("change"),1==a.active?($("#modal-edit :input[name=active]").prop("checked","checked"),$("#modal-edit :input[name=active]").val(1)):($("#modal-edit :input[name=active]").prop("checked",""),$("#modal-edit :input[name=active]").val(0)),e.preventDefault()}),$("#table tbody").on("click",".dt-delete",function(e){var a=n.row($(this).parents("tr")).data();$(this).confirmation("show"),$(this).on("confirmed.bs.confirmation",function(){$.ajax({url:routeDelete,type:"POST",data:{id:a.id},beforeSend:function(){App.showMask(!0,o)},complete:function(e,a){if(App.showMask(!1,o),"200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"success"==t.status?(toastr.success(t.message,"Success"),n.draw()):toastr.error(t.message,"Error")}}})}),e.preventDefault()});var s=$("#form-edit");s.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{minlength:2,required:!0},email:{required:!0,email:!0},username:{required:!0},confirm_password:{equalTo:"#modal-edit :input[name=password]"},"role-id":{required:!0}},errorPlacement:function(e,a){0<a.parents(".mt-radio-list").size()||0<a.parents(".mt-checkbox-list").size()?(0<a.parents(".mt-radio-list").size()&&e.appendTo(a.parents(".mt-radio-list")[0]),0<a.parents(".mt-checkbox-list").size()&&e.appendTo(a.parents(".mt-checkbox-list")[0])):0<a.parents(".mt-radio-inline").size()||0<a.parents(".mt-checkbox-inline").size()?(0<a.parents(".mt-radio-inline").size()&&e.appendTo(a.parents(".mt-radio-inline")[0]),0<a.parents(".mt-checkbox-inline").size()&&e.appendTo(a.parents(".mt-checkbox-inline")[0])):0<a.parent(".input-group").size()?e.insertAfter(a.parent(".input-group")):a.attr("data-error-container")?e.appendTo(a.attr("data-error-container")):e.insertAfter(a)},invalidHandler:function(e,a){toastr.error("Please check the entry fields.","Error")},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error")},submitHandler:function(n){var r=$(n).find("button[type=submit]:focus").attr("data");$.ajax({url:routeUpdate,type:"POST",data:s.serialize(),beforeSend:function(){App.showMask(!0,s)},complete:function(e,a){if(App.showMask(!1,s),"200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"success"==t.status?(toastr.success(t.message,"Success"),i=!0,"accept"==r&&$(n).find("button.cancel-form").click()):toastr.error(t.message,"Error")}}})}}),$(".cancel-form").on("click",function(e){i&&(n.draw(),i=!1)}),$(".excel").on("click",function(){var e={username:$("#search-section :input[name=username]").val(),role:$("#search-section :input[name=role]").val(),name:$("#search-section :input[name=name]").val(),email:$("#search-section :input[name=email]").val(),active:$("#search-section :input[name=active]").val()},a=routeExcel+"?"+$.param(e);window.location=a})});