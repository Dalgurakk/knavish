$(document).ready(function(){var r=!1;$.fn.dataTable.ext.errMode="none";var n=$("#table").on("error.dt",function(e,a,t,n){}).on("processing.dt",function(e,a,t){App.showMask(t,$(this)),App.reloadToolTips()}).on("init.dt",function(){}).DataTable({processing:!0,serverSide:!0,sDom:"ltip",iDisplayLength:25,ajax:{url:routeRead,type:"POST",complete:function(e,a){"200"!=e.status&&toastr.error("Please check your connection and try again.","Error on loading the content")}},order:[[3,"asc"]],columns:[{data:"id",name:"id",visible:!1},{data:"code",name:"code"},{data:"name",name:"name"},{data:"agefrom",name:"agefrom"},{data:"ageto",name:"ageto"},{data:"active",name:"active",className:"dt-center",data:function(e,a,t,n){var o='<span><i class="fa fa-close dt-active dt-active-0"></i></span>';return 1==e.active&&(o='<span><i class="fa fa-check dt-active dt-active-1"></i></span>'),o}},{targets:"actions",orderable:!1,name:"actions",className:"dt-center",data:function(e,a,t,n){return'<div class="dt-actions"><a class="btn btn-default btn-circle btn-icon-only btn-action dt-view" data-toggle="modal" href="#modal-info"><i class="glyphicon glyphicon-eye-open btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-edit" data-toggle="modal" href="#modal-edit"><i class="icon-pencil btn-action-icon"></i></a><a class="btn btn-default btn-circle btn-icon-only btn-action dt-delete" href="javascript:;" data-popout="true" data-placement="left"data-btn-ok-label="Yes" data-btn-ok-class="btn-sm btn-success"  data-btn-ok-icon-content="check" data-btn-cancel-label="No" data-btn-cancel-class="btn-sm btn-danger" data-btn-cancel-icon-content="close" data-title="Are you sure?" data-content=""><i class="icon-trash btn-action-icon"></i></a></div>'}}]});$("#table_length").hide(),$(".search").on("click",function(e){$("#search-section").slideToggle()}),$(".reload").on("click",function(e){n.draw()}),$(".add").on("click",function(){i.validate().resetForm(),i[0].reset()}),$(".lenght-option").on("click",function(){var e=$(this).attr("data");$(this).parent().parent().prev("a").text(e);var a=$("select[name=table_length]");a.val(e),a.change()}),$.validator.addMethod("greaterThan",function(e,a,t){return this.optional(a)||parseInt(e)>parseInt($(t).val())},"Invalid value.");var i=$("#form-add");i.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{required:!0},code:{required:!0},agefrom:{required:!0,number:!0,min:0,max:99},ageto:{required:!0,number:!0,min:0,max:99,greaterThan:"#modal-add :input[name=agefrom]"}},messages:{ageto:{greaterThan:"Must be greater than Age From."}},errorPlacement:function(e,a){0<a.parents(".mt-radio-list").size()||0<a.parents(".mt-checkbox-list").size()?(0<a.parents(".mt-radio-list").size()&&e.appendTo(a.parents(".mt-radio-list")[0]),0<a.parents(".mt-checkbox-list").size()&&e.appendTo(a.parents(".mt-checkbox-list")[0])):0<a.parents(".mt-radio-inline").size()||0<a.parents(".mt-checkbox-inline").size()?(0<a.parents(".mt-radio-inline").size()&&e.appendTo(a.parents(".mt-radio-inline")[0]),0<a.parents(".mt-checkbox-inline").size()&&e.appendTo(a.parents(".mt-checkbox-inline")[0])):0<a.parent(".input-group").size()?e.insertAfter(a.parent(".input-group")):a.attr("data-error-container")?e.appendTo(a.attr("data-error-container")):e.insertAfter(a)},invalidHandler:function(e,a){toastr.error("Please check the entry fields.","Error")},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error")},submitHandler:function(n){var o=$(n).find("button[type=submit]:focus").attr("data");$.ajax({url:routeCreate,type:"POST",data:i.serialize(),beforeSend:function(){App.showMask(!0,i)},complete:function(e,a){if(App.showMask(!1,i),"200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"success"==t.status?(toastr.success(t.message,"Success"),i[0].reset(),r=!0,"accept"==o&&$(n).find("button.cancel-form").click()):toastr.error(t.message,"Error")}}})}}),$(".mt-checkbox").change(function(){$(".mt-checkbox > input[type=checkbox]").is(":checked")?$(".mt-checkbox > input[type=checkbox]").val(1):$(".mt-checkbox > input[type=checkbox]").val(0)});var c=$("#form-edit");c.validate({errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,ignore:"",rules:{name:{required:!0},code:{required:!0},agefrom:{required:!0,number:!0,min:0,max:99},ageto:{required:!0,number:!0,min:0,max:99,greaterThan:"#modal-edit :input[name=agefrom]"}},messages:{ageto:{greaterThan:"Must be greater than From age."}},errorPlacement:function(e,a){0<a.parents(".mt-radio-list").size()||0<a.parents(".mt-checkbox-list").size()?(0<a.parents(".mt-radio-list").size()&&e.appendTo(a.parents(".mt-radio-list")[0]),0<a.parents(".mt-checkbox-list").size()&&e.appendTo(a.parents(".mt-checkbox-list")[0])):0<a.parents(".mt-radio-inline").size()||0<a.parents(".mt-checkbox-inline").size()?(0<a.parents(".mt-radio-inline").size()&&e.appendTo(a.parents(".mt-radio-inline")[0]),0<a.parents(".mt-checkbox-inline").size()&&e.appendTo(a.parents(".mt-checkbox-inline")[0])):0<a.parent(".input-group").size()?e.insertAfter(a.parent(".input-group")):a.attr("data-error-container")?e.appendTo(a.attr("data-error-container")):e.insertAfter(a)},invalidHandler:function(e,a){toastr.error("Please check the entry fields.","Error")},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error")},submitHandler:function(n){var o=$(n).find("button[type=submit]:focus").attr("data");$.ajax({url:routeUpdate,type:"POST",data:c.serialize(),beforeSend:function(){App.showMask(!0,c)},complete:function(e,a){if(App.showMask(!1,c),"200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"success"==t.status?(toastr.success(t.message,"Success"),r=!0,"accept"==o&&$(n).find("button.cancel-form").click()):toastr.error(t.message,"Error")}}})}}),$("#table tbody").on("click",".dt-view",function(e){var a=n.row($(this).parents("tr")).data();$("#modal-info :input[name=code]").val(a.code),$("#modal-info :input[name=name]").val(a.name),$("#modal-info :input[name=agefrom]").val(a.agefrom),$("#modal-info :input[name=ageto]").val(a.ageto),1==a.active?($("#modal-info :input[name=active]").prop("checked","checked"),$("#modal-info :input[name=active]").val(1)):($("#modal-info :input[name=active]").prop("checked",""),$("#modal-info :input[name=active]").val(0)),e.preventDefault()}),$("#table tbody").on("click",".dt-edit",function(e){c.validate().resetForm(),c[0].reset();var a=n.row($(this).parents("tr")).data();$("#modal-edit :input[name=id]").val(a.id),$("#modal-edit :input[name=code]").val(a.code),$("#modal-edit :input[name=name]").val(a.name),$("#modal-edit :input[name=agefrom]").val(a.agefrom),$("#modal-edit :input[name=ageto]").val(a.ageto),1==a.active?($("#modal-edit :input[name=active]").prop("checked","checked"),$("#modal-edit :input[name=active]").val(1)):($("#modal-edit :input[name=active]").prop("checked",""),$("#modal-edit :input[name=active]").val(0)),e.preventDefault()}),$("#table tbody").on("click",".dt-delete",function(e){var a=n.row($(this).parents("tr")).data();$(this).confirmation("show");var t=!1;$(this).on("confirmed.bs.confirmation",function(){t||$.ajax({url:routeDelete,type:"POST",data:{id:a.id},beforeSend:function(){App.showMask(!0,i)},complete:function(e,a){if(App.showMask(!1,i),"200"!=e.status)toastr.error("Please check your connection and try again.","Error on loading the content");else{var t=$.parseJSON(e.responseText);"success"==t.status?(toastr.success(t.message,"Success"),n.draw()):toastr.error(t.message,"Error")}},success:function(){t=!0}})}),e.preventDefault()}),$(".cancel-form").on("click",function(e){r&&(n.draw(),r=!1)}),$(".btn-search-reset").on("click",function(e){e.preventDefault(),$("#search-section :input[name=code]").val(""),$("#search-section :input[name=name]").val(""),$("#search-section :input[name=active]").val("")}),$(".btn-search-cancel").on("click",function(e){e.preventDefault(),$("#search-section").slideToggle()}),$(".btn-search-submit").on("click",function(e){e.preventDefault(),n.columns("code:name").search($("#search-section :input[name=code]").val()).columns("name:name").search($("#search-section :input[name=name]").val()).columns("active:name").search($("#search-section :input[name=active]").val()).draw()}),$(".excel").on("click",function(){var e={code:$("#search-section :input[name=code]").val(),name:$("#search-section :input[name=name]").val(),active:$("#search-section :input[name=active]").val()},a=routeExcel+"?"+$.param(e);window.location=a})});